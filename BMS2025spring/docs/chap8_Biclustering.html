<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Rをつかったバイクラスタリング分析の実習 – exametrikaパッケージによるテスト理論の実践</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap6_LRA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap8_Biclustering.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rをつかったバイクラスタリング分析の実習</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">exametrikaパッケージによるテスト理論の実践</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./exametrikaパッケージによるテスト理論の実践.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./exametrikaパッケージによるテスト理論の実践.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">はじめに</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap0_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rとexametrikaパッケージの導入</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_ItemTest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Rをつかった項目分析の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_IRT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rをつかった項目反応理論の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap6_LRA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rをつかった潜在クラス/ランク分析の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap8_Biclustering.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rをつかったバイクラスタリング分析の実習</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#準備しましょう" id="toc-準備しましょう" class="nav-link active" data-scroll-target="#準備しましょう"><span class="header-section-number">6.1</span> 準備しましょう</a>
  <ul class="collapse">
  <li><a href="#サンプルデータを用います" id="toc-サンプルデータを用います" class="nav-link" data-scroll-target="#サンプルデータを用います"><span class="header-section-number">6.1.1</span> サンプルデータを用います</a></li>
  </ul></li>
  <li><a href="#バイクラスタリングの実行" id="toc-バイクラスタリングの実行" class="nav-link" data-scroll-target="#バイクラスタリングの実行"><span class="header-section-number">6.2</span> バイクラスタリングの実行</a>
  <ul class="collapse">
  <li><a href="#アレイプロット" id="toc-アレイプロット" class="nav-link" data-scroll-target="#アレイプロット"><span class="header-section-number">6.2.1</span> アレイプロット</a></li>
  <li><a href="#受験生とクラスの関係" id="toc-受験生とクラスの関係" class="nav-link" data-scroll-target="#受験生とクラスの関係"><span class="header-section-number">6.2.2</span> 受験生とクラスの関係</a></li>
  <li><a href="#項目とフィールドの関係" id="toc-項目とフィールドの関係" class="nav-link" data-scroll-target="#項目とフィールドの関係"><span class="header-section-number">6.2.3</span> 項目とフィールドの関係</a></li>
  <li><a href="#クラスとフィールドの関係" id="toc-クラスとフィールドの関係" class="nav-link" data-scroll-target="#クラスとフィールドの関係"><span class="header-section-number">6.2.4</span> クラスとフィールドの関係</a></li>
  <li><a href="#テストとクラスの関係" id="toc-テストとクラスの関係" class="nav-link" data-scroll-target="#テストとクラスの関係"><span class="header-section-number">6.2.5</span> テストとクラスの関係</a></li>
  </ul></li>
  <li><a href="#ランクラスタリングの実行" id="toc-ランクラスタリングの実行" class="nav-link" data-scroll-target="#ランクラスタリングの実行"><span class="header-section-number">6.3</span> ランクラスタリングの実行</a>
  <ul class="collapse">
  <li><a href="#アレイプロット-1" id="toc-アレイプロット-1" class="nav-link" data-scroll-target="#アレイプロット-1"><span class="header-section-number">6.3.1</span> アレイプロット</a></li>
  <li><a href="#受験生とランクの関係" id="toc-受験生とランクの関係" class="nav-link" data-scroll-target="#受験生とランクの関係"><span class="header-section-number">6.3.2</span> 受験生とランクの関係</a></li>
  <li><a href="#項目とフィールドの関係-1" id="toc-項目とフィールドの関係-1" class="nav-link" data-scroll-target="#項目とフィールドの関係-1"><span class="header-section-number">6.3.3</span> 項目とフィールドの関係</a></li>
  <li><a href="#ランクとフィールドの関係" id="toc-ランクとフィールドの関係" class="nav-link" data-scroll-target="#ランクとフィールドの関係"><span class="header-section-number">6.3.4</span> ランクとフィールドの関係</a></li>
  <li><a href="#テストとランクの関係" id="toc-テストとランクの関係" class="nav-link" data-scroll-target="#テストとランクの関係"><span class="header-section-number">6.3.5</span> テストとランクの関係</a></li>
  </ul></li>
  <li><a href="#confirmatory-analysis" id="toc-confirmatory-analysis" class="nav-link" data-scroll-target="#confirmatory-analysis"><span class="header-section-number">6.4</span> Confirmatory Analysis</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis"><span class="header-section-number">6.5</span> Exploratory Analysis</a></li>
  <li><a href="#多値への展開" id="toc-多値への展開" class="nav-link" data-scroll-target="#多値への展開"><span class="header-section-number">6.6</span> 多値への展開</a>
  <ul class="collapse">
  <li><a href="#これができると何が嬉しいか" id="toc-これができると何が嬉しいか" class="nav-link" data-scroll-target="#これができると何が嬉しいか"><span class="header-section-number">6.6.1</span> これができると何が嬉しいか</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rをつかったバイクラスタリング分析の実習</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="準備しましょう" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="準備しましょう"><span class="header-section-number">6.1</span> 準備しましょう</h2>
<section id="サンプルデータを用います" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="サンプルデータを用います"><span class="header-section-number">6.1.1</span> サンプルデータを用います</h3>
<ul>
<li>RStudioでプロジェクトを開いているか確認してくださいね</li>
<li><code>exametrika</code>が持っている<code>J35S515</code>を例に</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exametrika)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> J35S515</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>U <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Item01 Item02 Item03 Item04 Item05 Item06 Item07 Item08 Item09 Item10
[1,]      0      0      0      0      0      0      0      1      1      0
[2,]      1      1      0      0      0      0      1      0      1      1
[3,]      1      0      0      0      0      0      1      1      0      1
[4,]      0      0      1      0      0      0      0      1      1      0
[5,]      1      0      0      0      0      0      1      0      0      0
[6,]      1      0      0      0      0      0      0      0      0      0
     Item11 Item12 Item13 Item14 Item15 Item16 Item17 Item18 Item19 Item20
[1,]      0      0      0      0      0      1      0      0      0      0
[2,]      1      1      1      1      0      0      1      0      0      0
[3,]      0      0      0      0      0      0      0      0      1      1
[4,]      0      0      0      0      0      0      0      0      0      0
[5,]      0      0      0      0      0      0      0      0      0      0
[6,]      0      0      0      0      0      0      0      0      0      0
     Item21 Item22 Item23 Item24 Item25 Item26 Item27 Item28 Item29 Item30
[1,]      0      0      0      0      0      0      0      0      0      0
[2,]      1      1      1      1      1      1      1      0      0      0
[3,]      0      0      0      0      0      0      0      0      0      0
[4,]      1      0      1      1      1      1      1      1      0      0
[5,]      0      0      0      0      0      0      0      0      0      0
[6,]      1      1      0      0      0      0      1      0      0      0
     Item31 Item32 Item33 Item34 Item35
[1,]      1      1      1      0      0
[2,]      1      1      0      0      0
[3,]      1      0      0      0      0
[4,]      1      1      0      1      0
[5,]      1      1      1      0      1
[6,]      1      1      0      0      1</code></pre>
</div>
</div>
</section>
</section>
<section id="バイクラスタリングの実行" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="バイクラスタリングの実行"><span class="header-section-number">6.2</span> バイクラスタリングの実行</h2>
<ul>
<li>何やら色々出てきますので，順次解説していきます</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Biclustering</span>(dat, <span class="at">nfld =</span> <span class="dv">5</span>, <span class="at">ncls =</span> <span class="dv">6</span>, <span class="at">method =</span> <span class="st">"B"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Biclustering is chosen.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
iter 1 log_lik -7966.66                                                         
iter 2 log_lik -7442.38                                                         
iter 3 log_lik -7266.35                                                         
iter 4 log_lik -7151.01                                                         
iter 5 log_lik -7023.94                                                         
iter 6 log_lik -6984.82                                                         
iter 7 log_lik -6950.27                                                         
iter 8 log_lik -6939.34                                                         
iter 9 log_lik -6930.89                                                         
iter 10 log_lik -6923.5                                                         
iter 11 log_lik -6914.56                                                        
iter 12 log_lik -6908.89                                                        
iter 13 log_lik -6906.84                                                        
iter 14 log_lik -6905.39                                                        
iter 15 log_lik -6904.24                                                        
iter 16 log_lik -6903.28                                                        
iter 17 log_lik -6902.41                                                        
iter 18 log_lik -6901.58                                                        
iter 19 log_lik -6900.74                                                        
iter 20 log_lik -6899.86                                                        
iter 21 log_lik -6898.9                                                         
iter 22 log_lik -6897.84                                                        
iter 23 log_lik -6896.66                                                        
iter 24 log_lik -6895.35                                                        
iter 25 log_lik -6893.92                                                        
iter 26 log_lik -6892.4                                                         
iter 27 log_lik -6890.85                                                        
iter 28 log_lik -6889.32                                                        
iter 29 log_lik -6887.9                                                         
iter 30 log_lik -6886.66                                                        
iter 31 log_lik -6885.67                                                        
iter 32 log_lik -6884.98                                                        
iter 33 log_lik -6884.58                                                        </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Biclustering Analysis

Biclustering Reference Matrix Profile
       Class1 Class2 Class3 Class4 Class5 Class6
Field1 0.6236 0.8636 0.8718  0.898  0.952  1.000
Field2 0.0627 0.3332 0.4255  0.919  0.990  1.000
Field3 0.2008 0.5431 0.2281  0.475  0.706  1.000
Field4 0.0495 0.2455 0.0782  0.233  0.648  0.983
Field5 0.0225 0.0545 0.0284  0.043  0.160  0.983

Field Reference Profile Indices
       Alpha     A Beta     B Gamma       C
Field1     1 0.240    1 0.624   0.0  0.0000
Field2     3 0.493    3 0.426   0.0  0.0000
Field3     1 0.342    4 0.475   0.2 -0.3149
Field4     4 0.415    5 0.648   0.2 -0.1673
Field5     5 0.823    5 0.160   0.2 -0.0261

                              Class 1 Class 2 Class 3 Class 4 Class 5 Class 6
Test Reference Profile          4.431  11.894   8.598  16.002  23.326  34.713
Latent Class Ditribution      157.000  64.000  82.000 106.000  89.000  17.000
Class Membership Distribution 146.105  73.232  85.753 106.414  86.529  16.968

Field Membership Profile
         CRR   LFE Field1 Field2 Field3 Field4 Field5
Item01 0.850 1.000  1.000  0.000  0.000  0.000  0.000
Item31 0.812 1.000  1.000  0.000  0.000  0.000  0.000
Item32 0.808 1.000  1.000  0.000  0.000  0.000  0.000
Item21 0.616 2.000  0.000  1.000  0.000  0.000  0.000
Item23 0.600 2.000  0.000  1.000  0.000  0.000  0.000
Item22 0.586 2.000  0.000  1.000  0.000  0.000  0.000
Item24 0.567 2.000  0.000  1.000  0.000  0.000  0.000
Item25 0.491 2.000  0.000  1.000  0.000  0.000  0.000
Item11 0.476 2.000  0.000  1.000  0.000  0.000  0.000
Item26 0.452 2.000  0.000  1.000  0.000  0.000  0.000
Item27 0.414 2.000  0.000  1.000  0.000  0.000  0.000
Item07 0.573 3.000  0.000  0.000  1.000  0.000  0.000
Item03 0.458 3.000  0.000  0.000  1.000  0.000  0.000
Item33 0.437 3.000  0.000  0.000  1.000  0.000  0.000
Item02 0.392 3.000  0.000  0.000  1.000  0.000  0.000
Item09 0.390 3.000  0.000  0.000  1.000  0.000  0.000
Item10 0.353 3.000  0.000  0.000  1.000  0.000  0.000
Item08 0.350 3.000  0.000  0.000  1.000  0.000  0.000
Item12 0.340 4.000  0.000  0.000  0.000  1.000  0.000
Item04 0.303 4.000  0.000  0.000  0.000  1.000  0.000
Item17 0.276 4.000  0.000  0.000  0.000  1.000  0.000
Item05 0.250 4.000  0.000  0.000  0.000  1.000  0.000
Item13 0.237 4.000  0.000  0.000  0.000  1.000  0.000
Item34 0.229 4.000  0.000  0.000  0.000  1.000  0.000
Item29 0.227 4.000  0.000  0.000  0.000  1.000  0.000
Item28 0.221 4.000  0.000  0.000  0.000  1.000  0.000
Item06 0.216 4.000  0.000  0.000  0.000  1.000  0.000
Item16 0.216 4.000  0.000  0.000  0.000  1.000  0.000
Item35 0.155 5.000  0.000  0.000  0.000  0.000  1.000
Item14 0.126 5.000  0.000  0.000  0.000  0.000  1.000
Item15 0.087 5.000  0.000  0.000  0.000  0.000  1.000
Item30 0.085 5.000  0.000  0.000  0.000  0.000  1.000
Item20 0.054 5.000  0.000  0.000  0.000  0.000  1.000
Item19 0.052 5.000  0.000  0.000  0.000  0.000  1.000
Item18 0.049 5.000  0.000  0.000  0.000  0.000  1.000
Latent Field Distribution
           Field 1 Field 2 Field 3 Field 4 Field 5
N of Items       3       8       7      10       7

Model Fit Indices
Number of Latent Class : 6
Number of Latent Field: 5
Number of EM cycle: 33 
                   value
model_log_like -6884.582
bench_log_like -5891.314
null_log_like  -9862.114
model_Chi_sq    1986.535
null_Chi_sq     7941.601
model_df        1160.000
null_df         1155.000
NFI                0.750
RFI                0.751
IFI                0.878
TLI                0.879
CFI                0.878
RMSEA              0.037
AIC             -333.465
CAIC           -6416.699
BIC            -5256.699</code></pre>
</div>
</div>
<section id="アレイプロット" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="アレイプロット"><span class="header-section-number">6.2.1</span> アレイプロット</h3>
<ul>
<li>うまく分類できたかどうかをアレイプロットで確認できます。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"Array"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="受験生とクラスの関係" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="受験生とクラスの関係"><span class="header-section-number">6.2.2</span> 受験生とクラスの関係</h3>
<section id="クラスメンバーシップとプロファイル" class="level4" data-number="6.2.2.1">
<h4 data-number="6.2.2.1" class="anchored" data-anchor-id="クラスメンバーシップとプロファイル"><span class="header-section-number">6.2.2.1</span> クラスメンバーシップとプロファイル</h4>
<p>クラスの分布をプロットします。</p>
<p>内部では，各受験者がどのクラスに所属するかの確率を推定しています。この確率をクラス・メンバーシップ・プロファイルといいます。数値で出力することも，プロットすることも可能です。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 丸めて出力</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(result<span class="sc">$</span>ClassMembership, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Class1   Class2   Class3   Class4   Class5 Class6
Student001 0.936080 0.048748 0.015172 0.000000 0.000000      0
Student002 0.000000 0.000247 0.000035 0.786721 0.212997      0
Student003 0.935542 0.048932 0.015526 0.000000 0.000000      0
Student004 0.000002 0.107544 0.153249 0.739188 0.000016      0
Student005 0.943018 0.015802 0.041179 0.000000 0.000000      0
Student006 0.020760 0.005789 0.973443 0.000008 0.000000      0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 図で出力</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"CMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="推定された所属クラス" class="level4" data-number="6.2.2.2">
<h4 data-number="6.2.2.2" class="anchored" data-anchor-id="推定された所属クラス"><span class="header-section-number">6.2.2.2</span> 推定された所属クラス</h4>
<p>この所属確率が最も高いものが，推定される所属クラスとなります。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>ClassEstimated <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 1 4 1 3</code></pre>
</div>
</div>
</section>
<section id="潜在クラス分布" class="level4" data-number="6.2.2.3">
<h4 data-number="6.2.2.3" class="anchored" data-anchor-id="潜在クラス分布"><span class="header-section-number">6.2.2.3</span> 潜在クラス分布</h4>
<p>メンバーシップは所属確率で，それをクラスごとに集計して分布を見るのがClass Membership Distributionです。</p>
<p>推定される所属クラス(推定値)で集計して分布を見るのがLatent Class Distributionです。</p>
<p>プロットの<code>type="LCD"</code>で両者が同時にプロットされます。</p>
<ul>
<li>棒グラフで表現されているのがLatent Class Distributionです。</li>
<li>折れ線グラフで表現されているのがClass Membership Distributionです。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"LCD"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="項目とフィールドの関係" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="項目とフィールドの関係"><span class="header-section-number">6.2.3</span> 項目とフィールドの関係</h3>
<p>内部では，各項目がどのフィールドに所属するかの確率を推定しています。この確率をフィールドメンバーシッププロファイルといい，<code>FieldMembership</code>という名前で保存されています。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(result<span class="sc">$</span>FieldMembership, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Field1 Field2  Field3  Field4 Field5
Item01      1      0 0.00000 0.00000      0
Item02      0      0 1.00000 0.00000      0
Item03      0      0 1.00000 0.00000      0
Item04      0      0 0.00000 1.00000      0
Item05      0      0 0.00000 1.00000      0
Item06      0      0 0.00000 1.00000      0
Item07      0      0 1.00000 0.00000      0
Item08      0      0 1.00000 0.00000      0
Item09      0      0 1.00000 0.00000      0
Item10      0      0 1.00000 0.00000      0
Item11      0      1 0.00000 0.00000      0
Item12      0      0 0.00012 0.99988      0
Item13      0      0 0.00000 1.00000      0
Item14      0      0 0.00000 0.00000      1
Item15      0      0 0.00000 0.00000      1
Item16      0      0 0.00000 1.00000      0
Item17      0      0 0.00000 1.00000      0
Item18      0      0 0.00000 0.00000      1
Item19      0      0 0.00000 0.00000      1
Item20      0      0 0.00000 0.00000      1
Item21      0      1 0.00000 0.00000      0
Item22      0      1 0.00000 0.00000      0
Item23      0      1 0.00000 0.00000      0
Item24      0      1 0.00000 0.00000      0
Item25      0      1 0.00000 0.00000      0
Item26      0      1 0.00000 0.00000      0
Item27      0      1 0.00000 0.00000      0
Item28      0      0 0.00000 1.00000      0
Item29      0      0 0.00000 1.00000      0
Item30      0      0 0.00000 0.00000      1
Item31      1      0 0.00000 0.00000      0
Item32      1      0 0.00000 0.00000      0
Item33      0      0 1.00000 0.00000      0
Item34      0      0 0.00000 1.00000      0
Item35      0      0 0.00000 0.00000      1</code></pre>
</div>
</div>
</section>
<section id="クラスとフィールドの関係" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="クラスとフィールドの関係"><span class="header-section-number">6.2.4</span> クラスとフィールドの関係</h3>
<section id="クラス参照ベクトル" class="level4" data-number="6.2.4.1">
<h4 data-number="6.2.4.1" class="anchored" data-anchor-id="クラス参照ベクトル"><span class="header-section-number">6.2.4.1</span> クラス参照ベクトル</h4>
<p>フィールドにおけるクラスごと正答率をプロットすることができます。クラス参照ベクトルClass Reference Vectorと呼ばれます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"CRV"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>これは数値で確認することもできます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>FRP</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Class1     Class2     Class3     Class4    Class5    Class6
Field1 0.62358989 0.86362311 0.87179729 0.89818946 0.9515799 1.0000000
Field2 0.06270755 0.33323234 0.42554990 0.91879529 0.9904507 1.0000000
Field3 0.20081642 0.54305218 0.22811379 0.47498694 0.7061406 1.0000000
Field4 0.04954076 0.24549999 0.07824042 0.23310794 0.6482247 0.9828854
Field5 0.02254831 0.05446897 0.02836654 0.04301178 0.1603798 0.9834310</code></pre>
</div>
</div>
</section>
<section id="フィールド参照プロファイル" class="level4" data-number="6.2.4.2">
<h4 data-number="6.2.4.2" class="anchored" data-anchor-id="フィールド参照プロファイル"><span class="header-section-number">6.2.4.2</span> フィールド参照プロファイル</h4>
<p>フィールドの特徴に注目し，クラスごと正答率をプロットすることができます。この図をフィールド参照プロファイルField Reference Profileといいます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"FRP"</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="テストとクラスの関係" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="テストとクラスの関係"><span class="header-section-number">6.2.5</span> テストとクラスの関係</h3>
<section id="テスト参照プロファイル" class="level4" data-number="6.2.5.1">
<h4 data-number="6.2.5.1" class="anchored" data-anchor-id="テスト参照プロファイル"><span class="header-section-number">6.2.5.1</span> テスト参照プロファイル</h4>
<p>テスト得点とクラスの分布を同時にプロットするものをテスト参照プロファイルTest Reference Profileといいます。</p>
<ul>
<li>棒グラフで表現されているのがLatent Class Distributionです。</li>
<li>折れ線グラフで表現されているのがTest Reference Profileで，クラスごとの期待得点です。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"TRP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="ランクラスタリングの実行" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="ランクラスタリングの実行"><span class="header-section-number">6.3</span> ランクラスタリングの実行</h2>
<ul>
<li>推定方法をRに変えると，潜在クラスが潜在ランクになります
<ul>
<li>アルゴリズムとしては，<code>LRA</code>の時と同じ順序性を保ったフィルタ行列を通しているだけです</li>
</ul></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>result.R <span class="ot">&lt;-</span> <span class="fu">Biclustering</span>(dat, <span class="at">nfld =</span> <span class="dv">5</span>, <span class="at">ncls =</span> <span class="dv">6</span>, <span class="at">method =</span> <span class="st">"R"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Ranklustering is chosen.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
iter 1 log_lik -8097.56                                                         
iter 2 log_lik -7669.21                                                         
iter 3 log_lik -7586.72                                                         
iter 4 log_lik -7568.24                                                         
iter 5 log_lik -7561.02                                                         
iter 6 log_lik -7557.34                                                         
iter 7 log_lik -7557.36                                                         

Strongly ordinal alignment condition was satisfied.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>result.R</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ranklustering Analysis

Ranklustering Reference Matrix Profile
        Rank1  Rank2  Rank3 Rank4 Rank5 Rank6
Field1 0.6495 0.7920 0.8809 0.914 0.938 0.970
Field2 0.0936 0.2775 0.6175 0.904 0.984 0.998
Field3 0.2247 0.3208 0.4403 0.616 0.751 0.899
Field4 0.1039 0.1860 0.2810 0.361 0.603 0.841
Field5 0.0329 0.0547 0.0934 0.130 0.262 0.598

Field Reference Profile Indices
       Alpha     A Beta     B Gamma C
Field1     1 0.142    1 0.650     0 0
Field2     2 0.340    3 0.617     0 0
Field3     3 0.176    3 0.440     0 0
Field4     4 0.242    5 0.603     0 0
Field5     5 0.336    6 0.598     0 0

                              Rank 1 Rank 2 Rank 3 Rank 4 Rank 5 Rank 6
Test Reference Profile         4.834  7.932 12.376 16.345 21.272 28.239
Latent Rank Ditribution      143.000 88.000 77.000 90.000 76.000 41.000
Rank Membership Distribution 133.892 96.100 83.688 84.373 73.955 42.992

Field Membership Profile
         CRR   LFE Field1 Field2 Field3 Field4 Field5
Item01 0.850 1.000  1.000  0.000  0.000  0.000  0.000
Item31 0.812 1.000  1.000  0.000  0.000  0.000  0.000
Item32 0.808 1.000  1.000  0.000  0.000  0.000  0.000
Item21 0.616 2.000  0.000  1.000  0.000  0.000  0.000
Item23 0.600 2.000  0.000  1.000  0.000  0.000  0.000
Item22 0.586 2.000  0.000  1.000  0.000  0.000  0.000
Item24 0.567 2.000  0.000  1.000  0.000  0.000  0.000
Item25 0.491 2.000  0.000  1.000  0.000  0.000  0.000
Item11 0.476 2.000  0.000  1.000  0.000  0.000  0.000
Item26 0.452 2.000  0.000  1.000  0.000  0.000  0.000
Item07 0.573 3.000  0.000  0.000  1.000  0.000  0.000
Item03 0.458 3.000  0.000  0.000  1.000  0.000  0.000
Item33 0.437 3.000  0.000  0.000  1.000  0.000  0.000
Item27 0.414 3.000  0.000  0.000  0.999  0.001  0.000
Item02 0.392 4.000  0.000  0.000  0.005  0.995  0.000
Item09 0.390 4.000  0.000  0.000  0.024  0.976  0.000
Item10 0.353 4.000  0.000  0.000  0.000  1.000  0.000
Item08 0.350 4.000  0.000  0.000  0.000  1.000  0.000
Item12 0.340 4.000  0.000  0.000  0.000  1.000  0.000
Item04 0.303 4.000  0.000  0.000  0.000  1.000  0.000
Item17 0.276 4.000  0.000  0.000  0.000  1.000  0.000
Item05 0.250 4.000  0.000  0.000  0.000  1.000  0.000
Item13 0.237 4.000  0.000  0.000  0.000  0.997  0.003
Item34 0.229 5.000  0.000  0.000  0.000  0.094  0.906
Item29 0.227 5.000  0.000  0.000  0.000  0.273  0.727
Item28 0.221 5.000  0.000  0.000  0.000  0.017  0.983
Item06 0.216 5.000  0.000  0.000  0.000  0.000  1.000
Item16 0.216 5.000  0.000  0.000  0.000  0.000  1.000
Item35 0.155 5.000  0.000  0.000  0.000  0.000  1.000
Item14 0.126 5.000  0.000  0.000  0.000  0.000  1.000
Item15 0.087 5.000  0.000  0.000  0.000  0.000  1.000
Item30 0.085 5.000  0.000  0.000  0.000  0.000  1.000
Item20 0.054 5.000  0.000  0.000  0.000  0.000  1.000
Item19 0.052 5.000  0.000  0.000  0.000  0.000  1.000
Item18 0.049 5.000  0.000  0.000  0.000  0.000  1.000
Latent Field Distribution
           Field 1 Field 2 Field 3 Field 4 Field 5
N of Items       3       7       4       9      12

Model Fit Indices
Number of Latent Rank : 6
Number of Latent Field: 5
Number of EM cycle: 7 
                   value
model_log_like -7273.063
bench_log_like -5891.314
null_log_like  -9862.114
model_Chi_sq    2763.498
null_Chi_sq     7941.601
model_df        1166.164
null_df         1155.000
NFI                0.652
RFI                0.655
IFI                0.764
TLI                0.767
CFI                0.765
RMSEA              0.052
AIC              431.170
CAIC           -5684.386
BIC            -4518.223
Strongly Ordinal Alignment Condition is Satisfied.
Weakly Ordinal Alignment Condition is Satisfied.</code></pre>
</div>
</div>
<section id="アレイプロット-1" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="アレイプロット-1"><span class="header-section-number">6.3.1</span> アレイプロット</h3>
<ul>
<li>うまく分類できたかどうかをアレイプロットで確認できます。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"Array"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="受験生とランクの関係" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="受験生とランクの関係"><span class="header-section-number">6.3.2</span> 受験生とランクの関係</h3>
<section id="ランクメンバーシップとプロファイル" class="level4" data-number="6.3.2.1">
<h4 data-number="6.3.2.1" class="anchored" data-anchor-id="ランクメンバーシップとプロファイル"><span class="header-section-number">6.3.2.1</span> ランクメンバーシップとプロファイル</h4>
<p>ランクの分布をプロットします。</p>
<p>内部では，各受験者がどのランクに所属するかの確率を推定しています。この確率をランク・メンバーシップ・プロファイルといいます。数値で出力することも，プロットすることも可能です。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 丸めて出力</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(result.R<span class="sc">$</span>ClassMembership, <span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Rank1    Rank2    Rank3    Rank4    Rank5    Rank6
Student001 0.730627 0.267616 0.001756 0.000000 0.000000 0.000000
Student002 0.000000 0.000002 0.007688 0.320350 0.671693 0.000266
Student003 0.613298 0.382232 0.004470 0.000000 0.000000 0.000000
Student004 0.000041 0.029656 0.756517 0.213429 0.000357 0.000000
Student005 0.758238 0.240019 0.001743 0.000000 0.000000 0.000000
Student006 0.256715 0.690129 0.053139 0.000018 0.000000 0.000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 図で出力</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"CMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="推定された所属ランク" class="level4" data-number="6.3.2.2">
<h4 data-number="6.3.2.2" class="anchored" data-anchor-id="推定された所属ランク"><span class="header-section-number">6.3.2.2</span> 推定された所属ランク</h4>
<p>この所属確率が最も高いものが，推定される所属ランクとなります。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>result.R<span class="sc">$</span>ClassEstimated <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 5 1 3 1 2</code></pre>
</div>
</div>
</section>
<section id="潜在ランク分布" class="level4" data-number="6.3.2.3">
<h4 data-number="6.3.2.3" class="anchored" data-anchor-id="潜在ランク分布"><span class="header-section-number">6.3.2.3</span> 潜在ランク分布</h4>
<p>メンバーシップは所属確率で，それをランクごとに集計して分布を見るのがRank Membership Distributionです。</p>
<p>推定される所属クラス(推定値)で集計して分布を見るのがLatent Rank Distributionです。</p>
<p>プロットの<code>type="LRD"</code>で両者が同時にプロットされます。</p>
<ul>
<li>棒グラフで表現されているのがLatent Rank Distributionです。</li>
<li>折れ線グラフで表現されているのがRank Membership Distributionです。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"LRD"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="項目とフィールドの関係-1" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="項目とフィールドの関係-1"><span class="header-section-number">6.3.3</span> 項目とフィールドの関係</h3>
<p>内部では，各項目がどのフィールドに所属するかの確率を推定しています。この確率をフィールドメンバーシッププロファイルといい，<code>FieldMembership</code>という名前で保存されています。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(result.R<span class="sc">$</span>FieldMembership, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Field1 Field2  Field3  Field4  Field5
Item01      1      0 0.00000 0.00000 0.00000
Item02      0      0 0.00450 0.99550 0.00000
Item03      0      0 1.00000 0.00000 0.00000
Item04      0      0 0.00000 1.00000 0.00000
Item05      0      0 0.00000 1.00000 0.00000
Item06      0      0 0.00000 0.00027 0.99973
Item07      0      0 1.00000 0.00000 0.00000
Item08      0      0 0.00000 1.00000 0.00000
Item09      0      0 0.02413 0.97587 0.00000
Item10      0      0 0.00000 1.00000 0.00000
Item11      0      1 0.00000 0.00000 0.00000
Item12      0      0 0.00000 1.00000 0.00000
Item13      0      0 0.00000 0.99741 0.00259
Item14      0      0 0.00000 0.00000 1.00000
Item15      0      0 0.00000 0.00000 1.00000
Item16      0      0 0.00000 0.00012 0.99988
Item17      0      0 0.00000 1.00000 0.00000
Item18      0      0 0.00000 0.00000 1.00000
Item19      0      0 0.00000 0.00000 1.00000
Item20      0      0 0.00000 0.00000 1.00000
Item21      0      1 0.00000 0.00000 0.00000
Item22      0      1 0.00000 0.00000 0.00000
Item23      0      1 0.00000 0.00000 0.00000
Item24      0      1 0.00000 0.00000 0.00000
Item25      0      1 0.00000 0.00000 0.00000
Item26      0      1 0.00000 0.00000 0.00000
Item27      0      0 0.99948 0.00052 0.00000
Item28      0      0 0.00000 0.01708 0.98292
Item29      0      0 0.00000 0.27290 0.72710
Item30      0      0 0.00000 0.00000 1.00000
Item31      1      0 0.00000 0.00000 0.00000
Item32      1      0 0.00000 0.00000 0.00000
Item33      0      0 1.00000 0.00000 0.00000
Item34      0      0 0.00000 0.09368 0.90632
Item35      0      0 0.00000 0.00000 1.00000</code></pre>
</div>
</div>
</section>
<section id="ランクとフィールドの関係" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="ランクとフィールドの関係"><span class="header-section-number">6.3.4</span> ランクとフィールドの関係</h3>
<section id="ランク参照ベクトル" class="level4" data-number="6.3.4.1">
<h4 data-number="6.3.4.1" class="anchored" data-anchor-id="ランク参照ベクトル"><span class="header-section-number">6.3.4.1</span> ランク参照ベクトル</h4>
<p>フィールドにおけるランクごと正答率をプロットすることができます。ランク参照ベクトルRank Reference Vectorと呼ばれます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"RRV"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>これは数値で確認することもできます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>result.R<span class="sc">$</span>FRP</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Rank1      Rank2      Rank3     Rank4     Rank5     Rank6
Field1 0.64951141 0.79197342 0.88093148 0.9140316 0.9381373 0.9701273
Field2 0.09362918 0.27752126 0.61746787 0.9036746 0.9835653 0.9979939
Field3 0.22472428 0.32079306 0.44027355 0.6163989 0.7507110 0.8988009
Field4 0.10394873 0.18598451 0.28100007 0.3614656 0.6030432 0.8411943
Field5 0.03293073 0.05469207 0.09344104 0.1298351 0.2618470 0.5980969</code></pre>
</div>
</div>
</section>
<section id="フィールド参照プロファイル-1" class="level4" data-number="6.3.4.2">
<h4 data-number="6.3.4.2" class="anchored" data-anchor-id="フィールド参照プロファイル-1"><span class="header-section-number">6.3.4.2</span> フィールド参照プロファイル</h4>
<p>フィールドの特徴に注目し，ランクごと正答率をプロットすることができます。この図をフィールド参照プロファイルField Reference Profileといいます。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"FRP"</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="テストとランクの関係" class="level3" data-number="6.3.5">
<h3 data-number="6.3.5" class="anchored" data-anchor-id="テストとランクの関係"><span class="header-section-number">6.3.5</span> テストとランクの関係</h3>
<section id="テスト参照プロファイル-1" class="level4" data-number="6.3.5.1">
<h4 data-number="6.3.5.1" class="anchored" data-anchor-id="テスト参照プロファイル-1"><span class="header-section-number">6.3.5.1</span> テスト参照プロファイル</h4>
<p>テスト得点とランクの分布を同時にプロットするものをテスト参照プロファイルTest Reference Profileといいます。</p>
<ul>
<li>棒グラフで表現されているのがLatent Rank Distributionです。</li>
<li>折れ線グラフで表現されているのがTest Reference Profileで，ランクごとの期待得点です。</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R, <span class="at">type =</span> <span class="st">"TRP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="confirmatory-analysis" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="confirmatory-analysis"><span class="header-section-number">6.4</span> Confirmatory Analysis</h2>
<ul>
<li>どの項目がどのフィールドに入るかを確認的に決めることができます。
<ul>
<li><code>conf</code>オプションに項目とフィールドの対応を記したベクトル，あるいは行列をあたえると，強制的にその割り振りで推定します。</li>
<li>項目がテストの領域などに対応している仮説がある場合に便利です。</li>
</ul></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>result.R.conf <span class="ot">&lt;-</span> <span class="fu">Biclustering</span>(dat,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfld =</span> <span class="dv">5</span>, <span class="at">ncls =</span> <span class="dv">6</span>, <span class="at">method =</span> <span class="st">"R"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf =</span> <span class="fu">c</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Ranklustering is chosen.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Confirmatory Clustering is chosen.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
iter 1 log_lik -9468.24                                                         
iter 2 log_lik -9272.71                                                         
iter 3 log_lik -9258.44                                                         
iter 4 log_lik -9250.23                                                         
iter 5 log_lik -9244.67                                                         
iter 6 log_lik -9242.74                                                         
iter 7 log_lik -9243.17                                                         

Strongly ordinal alignment condition was satisfied.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R.conf, <span class="at">type =</span> <span class="st">"RRV"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.R.conf, <span class="at">type =</span> <span class="st">"TRP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap8_Biclustering_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exploratory-analysis" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="exploratory-analysis"><span class="header-section-number">6.5</span> Exploratory Analysis</h2>
<ul>
<li>最適なフィールド数，クラス数がわからない場合は探索的なアプローチも可能です
<ul>
<li>計算自体はそこまで遅くないので，適合度指標などを参考にグリッドサーチ(総当たり！)も悪くないアプローチです</li>
<li>IRMはノンパラメトリックな手法で潜在的なクラスを自動探索しますが，時間がかかります。</li>
</ul></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result.IRM <span class="ot">&lt;-</span> <span class="fu">IRM</span>(dat, <span class="at">gamma_c =</span> <span class="dv">1</span>, <span class="at">gamma_f =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in IRM(dat, gamma_c = 1, gamma_f = 1, verbose = TRUE): 'IRM' は廃止予定です
'Biclustering_IRM' を代わりに使って下さい
help("Deprecated") を見て下さい</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 1: match=0 nfld=15 ncls=30</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 2: match=0 nfld=12 ncls=27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 3: match=1 nfld=12 ncls=24</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 4: match=2 nfld=12 ncls=23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 5: match=3 nfld=12 ncls=23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 6: match=0 nfld=12 ncls=23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 7: match=1 nfld=12 ncls=23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 8: match=2 nfld=12 ncls=23</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 9: match=3 nfld=12 ncls=21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 10: match=4 nfld=12 ncls=21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iter 11: match=5 nfld=12 ncls=21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adjusting classes: BIC=-99592.5 ncls=21 (min size &lt; 20)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adjusting classes: BIC=-99980.4 ncls=20 (min size &lt; 20)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adjusting classes: BIC=-99959.7 ncls=19 (min size &lt; 20)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adjusting classes: BIC=-99988.3 ncls=18 (min size &lt; 20)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Adjusting classes: BIC=-100001.3 ncls=17 (min size &lt; 20)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>result.IRM</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bicluster Reference Matrix
        Class1 Class2  Class3 Class4 Class5 Class6 Class7 Class8 Class9 Class10
Field1       0 0.5000 0.61988 0.9722 0.8384 0.7619 0.9231 0.9697 0.8116  0.9259
Field2       0 0.0303 0.00000 0.0417 0.8485 0.8333 0.7500 0.7045 0.6957  0.9306
Field3       0 0.0379 0.43860 0.0729 0.2273 0.9048 0.1731 0.9091 0.2174  1.0000
Field4       0 0.0152 0.10526 0.0903 0.1717 0.4127 0.0000 0.1364 0.0580  0.8796
Field5       0 0.0871 0.00877 0.1302 0.1061 0.0833 0.5865 0.3068 0.8587  0.3958
Field6       0 0.2636 0.26316 0.2375 0.4000 0.0762 0.5692 0.3364 0.4261  0.5056
Field7       0 0.0947 0.07895 0.0469 0.0379 0.0714 0.3750 0.2045 0.1413  0.1389
Field8       0 0.0000 0.00877 0.0208 0.0000 0.0000 0.0000 0.1136 0.9348  0.0000
Field9       0 0.0379 0.00877 0.0000 0.0455 0.0000 0.0000 0.1818 0.0652  0.0000
Field10      0 0.0152 0.20175 0.1875 0.2879 0.1429 0.0962 0.1136 0.2174  0.1806
Field11      0 0.0152 0.01170 0.0000 0.0000 0.0000 0.0641 0.0152 0.0000  0.0648
Field12      0 0.0455 0.00000 0.0208 0.0808 0.0000 0.0000 0.0000 0.0000  0.0000
        Class11 Class12 Class13 Class14 Class15 Class16
Field1   0.8667  0.8571   0.949   0.971   0.963       1
Field2   0.9500  0.8857   1.000   1.000   1.000       1
Field3   1.0000  0.9286   0.985   1.000   0.989       1
Field4   0.9889  0.8000   0.960   0.971   0.993       1
Field5   0.2667  0.8929   0.492   1.000   0.944       1
Field6   0.4000  0.4800   0.594   0.557   0.702       1
Field7   0.1750  0.2500   0.848   0.413   0.728       1
Field8   0.0000  0.9429   0.000   0.130   0.967       1
Field9   0.7833  0.0571   0.621   0.500   0.733       1
Field10  0.1167  0.1714   0.227   0.174   0.278       1
Field11  0.0556  0.0762   0.253   0.174   0.304       1
Field12  0.0000  0.0000   0.000   0.217   0.000       1
                         class 1 class 2 class 3 class 4 class 5 class 6
Test Reference Profile         0   4.015   5.193   5.792   8.667   8.286
Latent class Ditribution       2  66.000  57.000  48.000  33.000  21.000
                         class 7 class 8 class 9 class 10 class 11 class 12
Test Reference Profile    11.692  11.136      13     14.5     15.2   18.143
Latent class Ditribution  26.000  22.000      23     36.0     30.0   35.000
                         class 13 class 14 class 15 class 16
Test Reference Profile     20.485   21.043   24.911       35
Latent class Ditribution   33.000   23.000   45.000       15
Latent Field Distribution
           Field 1 Field 2 Field 3 Field 4 Field 5 Field 6 Field 7 Field 8
N of Items       3       2       2       3       4       5       4       2
           Field 9 Field 10 Field 11 Field 12
N of Items       2        2        3        3

Model Fit Indices
Number of Latent Class : 16
Number of Latent Field: 12
Number of EM cycle: 6 
                   value
model_log_like -5664.270
bench_log_like -5891.314
null_log_like  -9862.114
model_Chi_sq    -454.089
null_Chi_sq     7941.601
model_df         998.000
null_df         1155.000
NFI                1.000
RFI                1.000
IFI                1.000
TLI                1.000
CFI                1.000
RMSEA              0.000
AIC            -2450.089
CAIC           -7683.768
BIC            -6685.768</code></pre>
</div>
</div>
</section>
<section id="多値への展開" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="多値への展開"><span class="header-section-number">6.6</span> 多値への展開</h2>
<ul>
<li>多値モデル(名義尺度)への展開も可能です。近日中に実装する予定です
<ul>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="PolyBiclustering.png" class="img-fluid figure-img"></p>
<figcaption>Biclustering for Polydata</figcaption>
</figure>
</div></li>
</ul></li>
<li>多値モデル(順序尺度)への展開も可能なはずです。出来次第，実装する予定です</li>
</ul>
<section id="これができると何が嬉しいか" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="これができると何が嬉しいか"><span class="header-section-number">6.6.1</span> これができると何が嬉しいか</h3>
<ul>
<li>表面上の類似性に基づく分類なので，データ生成メカニズムを仮定しません
<ul>
<li>個人間比較を必要としないので，社会的態度のような仮定を満たさない心理的データの分析ができます</li>
<li>スコアではなく反応パターンで項目や受検者を分類します；生態学的妥当性の高い心理尺度の作成，利用ができます。</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap6_LRA.html" class="pagination-link" aria-label="Rをつかった潜在クラス/ランク分析の実習">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rをつかった潜在クラス/ランク分析の実習</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>