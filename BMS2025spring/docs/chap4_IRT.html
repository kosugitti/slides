<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Rをつかった項目反応理論の実習 – exametrikaパッケージによるテスト理論の実践</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap6_LRA.html" rel="next">
<link href="./chap2_ItemTest.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap4_IRT.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rをつかった項目反応理論の実習</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">exametrikaパッケージによるテスト理論の実践</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./exametrikaパッケージによるテスト理論の実践.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./exametrikaパッケージによるテスト理論の実践.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">はじめに</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap0_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rとexametrikaパッケージの導入</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap2_ItemTest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Rをつかった項目分析の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap4_IRT.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rをつかった項目反応理論の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap6_LRA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rをつかった潜在クラス/ランク分析の実習</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap8_Biclustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rをつかったバイクラスタリング分析の実習</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#準備しましょう" id="toc-準備しましょう" class="nav-link active" data-scroll-target="#準備しましょう"><span class="header-section-number">4.1</span> 準備しましょう</a>
  <ul class="collapse">
  <li><a href="#サンプルデータを用います" id="toc-サンプルデータを用います" class="nav-link" data-scroll-target="#サンプルデータを用います"><span class="header-section-number">4.1.1</span> サンプルデータを用います</a></li>
  </ul></li>
  <li><a href="#実行しちゃいましょう" id="toc-実行しちゃいましょう" class="nav-link" data-scroll-target="#実行しちゃいましょう"><span class="header-section-number">4.2</span> 実行しちゃいましょう</a></li>
  <li><a href="#モデル適合度" id="toc-モデル適合度" class="nav-link" data-scroll-target="#モデル適合度"><span class="header-section-number">4.3</span> モデル適合度</a>
  <ul class="collapse">
  <li><a href="#モデルの評価" id="toc-モデルの評価" class="nav-link" data-scroll-target="#モデルの評価"><span class="header-section-number">4.3.1</span> モデルの評価</a></li>
  <li><a href="#改めて確認してみましょう" id="toc-改めて確認してみましょう" class="nav-link" data-scroll-target="#改めて確認してみましょう"><span class="header-section-number">4.3.2</span> 改めて確認してみましょう</a></li>
  <li><a href="#可視化しましょう" id="toc-可視化しましょう" class="nav-link" data-scroll-target="#可視化しましょう"><span class="header-section-number">4.3.3</span> 可視化しましょう</a></li>
  <li><a href="#受検者の情報も含まれています" id="toc-受検者の情報も含まれています" class="nav-link" data-scroll-target="#受検者の情報も含まれています"><span class="header-section-number">4.3.4</span> 受検者の情報も含まれています</a></li>
  <li><a href="#q3行列" id="toc-q3行列" class="nav-link" data-scroll-target="#q3行列"><span class="header-section-number">4.3.5</span> Q3行列</a></li>
  </ul></li>
  <li><a href="#多値への展開" id="toc-多値への展開" class="nav-link" data-scroll-target="#多値への展開"><span class="header-section-number">4.4</span> 多値への展開</a>
  <ul class="collapse">
  <li><a href="#段階反応モデル" id="toc-段階反応モデル" class="nav-link" data-scroll-target="#段階反応モデル"><span class="header-section-number">4.4.1</span> 段階反応モデル</a></li>
  <li><a href="#可視化しましょう-1" id="toc-可視化しましょう-1" class="nav-link" data-scroll-target="#可視化しましょう-1"><span class="header-section-number">4.4.2</span> 可視化しましょう</a></li>
  </ul></li>
  <li><a href="#コラムgrmと他のモデル" id="toc-コラムgrmと他のモデル" class="nav-link" data-scroll-target="#コラムgrmと他のモデル"><span class="header-section-number">4.5</span> コラム：GRMと他のモデル</a></li>
  <li><a href="#コラム態度測定論" id="toc-コラム態度測定論" class="nav-link" data-scroll-target="#コラム態度測定論"><span class="header-section-number">4.6</span> コラム：態度測定論</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Rをつかった項目反応理論の実習</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="準備しましょう" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="準備しましょう"><span class="header-section-number">4.1</span> 準備しましょう</h2>
<section id="サンプルデータを用います" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="サンプルデータを用います"><span class="header-section-number">4.1.1</span> サンプルデータを用います</h3>
<ul>
<li>RStudioでプロジェクトを開いているか確認してくださいね</li>
<li><code>exametrika</code>が持っている<code>J15S500</code>を例に</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exametrika)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: igraph</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> J15S500</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>U <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Item01 Item02 Item03 Item04 Item05 Item06 Item07 Item08 Item09 Item10
[1,]      0      1      1      0      1      1      0      0      0      1
[2,]      1      1      1      1      1      1      0      1      0      1
[3,]      1      1      1      1      1      1      0      0      0      1
[4,]      1      1      1      1      1      1      1      1      0      0
[5,]      1      1      0      1      1      0      0      0      0      1
[6,]      1      1      1      1      1      1      1      1      0      0
     Item11 Item12 Item13 Item14 Item15
[1,]      1      0      1      0      1
[2,]      0      0      1      0      1
[3,]      0      0      1      1      1
[4,]      0      1      1      1      0
[5,]      0      0      0      1      0
[6,]      1      0      1      1      1</code></pre>
</div>
</div>
</section>
</section>
<section id="実行しちゃいましょう" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="実行しちゃいましょう"><span class="header-section-number">4.2</span> 実行しちゃいましょう</h2>
<ul>
<li>何やら色々出てきますので，順次解説していきます</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">IRT</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
iter 1 LogLik -3915.61 
iter 2 LogLik -3901.1 
iter 3 LogLik -3896.89 
iter 4
LogLik -3894.98 
iter 5 LogLik -3894.02 
iter 6 LogLik -3893.53 
iter 7 LogLik
-3893.28 
iter 8 LogLik -3893.15 
iter 9 LogLik -3893.08 
iter 10 LogLik -3893.04

iter 11 LogLik -3893.03</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Item Parameters
       slope location PSD(slope) PSD(location)
Item01 0.698   -1.683     0.1093         0.266
Item02 0.810   -1.552     0.1166         0.221
Item03 0.559   -1.838     0.0988         0.338
Item04 1.416   -1.178     0.1569         0.113
Item05 0.681   -2.242     0.1152         0.360
Item06 0.997   -2.162     0.1499         0.273
Item07 1.084   -1.039     0.1281         0.130
Item08 0.694   -0.558     0.1002         0.153
Item09 0.347    1.630     0.0766         0.427
Item10 0.492   -1.421     0.0907         0.306
Item11 1.122    1.020     0.1314         0.124
Item12 1.216    1.031     0.1385         0.117
Item13 0.875   -0.720     0.1111         0.133
Item14 1.200   -1.232     0.1407         0.134
Item15 0.823   -1.203     0.1127         0.180

Item Fit Indices
       model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
Item01       -263.524       -240.190      -283.343       46.669      86.307
Item02       -252.914       -235.436      -278.949       34.954      87.025
Item03       -281.083       -260.906      -293.598       40.353      65.383
Item04       -205.851       -192.072      -265.962       27.558     147.780
Item05       -232.072       -206.537      -247.403       51.070      81.732
Item06       -173.930       -153.940      -198.817       39.981      89.755
Item07       -252.039       -228.379      -298.345       47.320     139.933
Item08       -313.754       -293.225      -338.789       41.057      91.127
Item09       -325.692       -300.492      -327.842       50.399      54.700
Item10       -309.448       -288.198      -319.850       42.500      63.303
Item11       -250.836       -224.085      -299.265       53.501     150.360
Item12       -240.247       -214.797      -293.598       50.900     157.603
Item13       -291.816       -262.031      -328.396       59.571     132.730
Item14       -224.330       -204.953      -273.212       38.754     136.519
Item15       -273.120       -254.764      -302.847       36.713      96.166
       model_df null_df   NFI   RFI   IFI   TLI   CFI RMSEA    AIC    CAIC
Item01       12      13 0.459 0.414 0.533 0.488 0.527 0.076 22.669 -27.930
Item02       12      13 0.598 0.565 0.694 0.664 0.690 0.062 10.954 -39.645
Item03       12      13 0.383 0.331 0.469 0.414 0.459 0.069 16.353 -34.246
Item04       12      13 0.814 0.798 0.885 0.875 0.885 0.051  3.558 -47.041
Item05       12      13 0.375 0.323 0.440 0.384 0.432 0.081 27.070 -23.529
Item06       12      13 0.555 0.517 0.640 0.605 0.635 0.068 15.981 -34.619
Item07       12      13 0.662 0.634 0.724 0.699 0.722 0.077 23.320 -27.279
Item08       12      13 0.549 0.512 0.633 0.597 0.628 0.070 17.057 -33.542
Item09       12      13 0.079 0.002 0.101 0.002 0.079 0.080 26.399 -24.201
Item10       12      13 0.329 0.273 0.405 0.343 0.394 0.071 18.500 -32.099
Item11       12      13 0.644 0.615 0.700 0.673 0.698 0.083 29.501 -21.099
Item12       12      13 0.677 0.650 0.733 0.709 0.731 0.081 26.900 -23.699
Item13       12      13 0.551 0.514 0.606 0.570 0.603 0.089 35.571 -15.028
Item14       12      13 0.716 0.692 0.785 0.765 0.783 0.067 14.754 -35.846
Item15       12      13 0.618 0.586 0.706 0.678 0.703 0.064 12.713 -37.886
           BIC
Item01 -27.906
Item02 -39.621
Item03 -34.222
Item04 -47.017
Item05 -23.505
Item06 -34.595
Item07 -27.255
Item08 -33.518
Item09 -24.177
Item10 -32.076
Item11 -21.075
Item12 -23.675
Item13 -15.004
Item14 -35.822
Item15 -37.862

Model Fit Indices
                   value
model_log_like -3890.655
bench_log_like -3560.005
null_log_like  -4350.217
model_Chi_sq     661.300
null_Chi_sq     1580.424
model_df         180.000
null_df          195.000
NFI                0.582
RFI                0.547
IFI                0.656
TLI                0.624
CFI                0.653
RMSEA              0.073
AIC              301.300
CAIC            -457.689
BIC             -457.330</code></pre>
</div>
</div>
</section>
<section id="モデル適合度" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="モデル適合度"><span class="header-section-number">4.3</span> モデル適合度</h2>
<ul>
<li>尤度Likelihoodとは，観測されたデータが特定のパラメータを持つモデルから生成された可能性を表します。<span class="math inline">\([0,1]\)</span>の範囲にあって，<span class="math inline">\(1\)</span>に近いほど「ありえそう」であることを表します。</li>
<li>対数尤度Log-likelihoodとは，その対数をとったものです。
<ul>
<li>尤度の計算は非常に小さな桁数まで重要なので，計算の精度を保つために対数を取ります</li>
</ul></li>
<li>対数尤度の範囲は<span class="math inline">\((-\inf,0]\)</span>で，<span class="math inline">\(0\)</span>に近いほど「ありえそう」であることを表します。</li>
</ul>
<section id="モデルの評価" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="モデルの評価"><span class="header-section-number">4.3.1</span> モデルの評価</h3>
<ul>
<li>モデルを評価する時に，「データにバッチリ完璧に当てはまってるぜモデル」と「データなんか関係ない完璧に当てはまってないモデル」を考えます</li>
<li>前者を飽和モデル(saturated model)，後者をヌルモデル(null model)といいます</li>
<li>飽和モデルの代わりに，実質的な飽和モデル/ベンチマークになるモデルと比較することもあります</li>
<li>実際に推定したモデルはこの量モデルの間のどこかに入るはずですね</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="modelFItinSEM.png" class="img-fluid figure-img"></p>
<figcaption>Test Data Enginieering,P.139</figcaption>
</figure>
</div>
<ul>
<li>カイ二乗(Chi-square,<span class="math inline">\(\chi^2\)</span>)値は，対数尤度に変換した後のモデル間の距離と考えることができます</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ChisqTransFormation.png" class="img-fluid figure-img"></p>
<figcaption>Test Data Engineering,P.144</figcaption>
</figure>
</div>
<ul>
<li>SEMで用いられる標準化された指標は，カイ二乗値を変換・標準化して表現したものです</li>
<li><code>exametrika</code>ではこれらの指標を適合度として表示します</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="otherIndices.png" class="img-fluid figure-img"></p>
<figcaption>Test Data Enginieering,P.148</figcaption>
</figure>
</div>
<ul>
<li>情報量基準も同様に，カイ二乗値に基づいて考えることができます</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="InformationCriteria.png" class="img-fluid figure-img"></p>
<figcaption>Test Data Engineering,P.150</figcaption>
</figure>
</div>
</section>
<section id="改めて確認してみましょう" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="改めて確認してみましょう"><span class="header-section-number">4.3.2</span> 改めて確認してみましょう</h3>
<ul>
<li><code>TestFitIndices</code>でテスト全体の適合度指標にアクセスできます。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>TestFitIndices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq model_df
1      -3890.655      -3560.005     -4350.217     661.2999    1580.424      180
  null_df      NFI       RFI       IFI       TLI       CFI      RMSEA      AIC
1     195 0.581568 0.5466987 0.6563184 0.6236472 0.6525974 0.07320173 301.2999
       CAIC       BIC
1 -457.6892 -457.3296</code></pre>
</div>
</div>
<ul>
<li><code>ItemFitIndices</code>で項目ごとの適合度指標にアクセスできます。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>ItemFitIndices</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
Item01      -263.5243      -240.1896     -283.3432     46.66935    86.30724
Item02      -252.9135      -235.4364     -278.9486     34.95429    87.02454
Item03      -281.0830      -260.9064     -293.5981     40.35319    65.38341
Item04      -205.8510      -192.0718     -265.9618     27.55846   147.77999
Item05      -232.0722      -206.5372     -247.4032     51.06995    81.73195
Item06      -173.9301      -153.9397     -198.8174     39.98072    89.75530
Item07      -252.0388      -228.3788     -298.3455     47.32008   139.93348
Item08      -313.7538      -293.2252     -338.7888     41.05728    91.12723
Item09      -325.6916      -300.4923     -327.8422     50.39860    54.69970
Item10      -309.4483      -288.1984     -319.8497     42.49979    63.30265
Item11      -250.8358      -224.0855     -299.2653     53.50067   150.35960
Item12      -240.2466      -214.7967     -293.5981     50.89986   157.60288
Item13      -291.8161      -262.0307     -328.3959     59.57086   132.73044
Item14      -224.3296      -204.9528     -273.2123     38.75364   136.51897
Item15      -273.1202      -254.7637     -302.8469     36.71312    96.16648
       model_df null_df        NFI       RFI       IFI         TLI        CFI
Item01       12      13 0.45926499 0.4142037 0.5334325 0.487656895 0.52706790
Item02       12      13 0.59833985 0.5648682 0.6940429 0.664068880 0.68990974
Item03       12      13 0.38282214 0.3313907 0.4688763 0.413631927 0.45873716
Item04       12      13 0.81351698 0.7979767 0.8854142 0.874944362 0.88456403
Item05       12      13 0.37515318 0.3230826 0.4397124 0.384190640 0.43156059
Item06       12      13 0.55455866 0.5174385 0.6401439 0.605076809 0.63545552
Item07       12      13 0.66183876 0.6336587 0.7239184 0.698555345 0.72174340
Item08       12      13 0.54945108 0.5119053 0.6327778 0.597083954 0.62807750
Item09       12      13 0.07863114 0.0018504 0.1007290 0.002427267 0.07916363
Item10       12      13 0.32862537 0.2726775 0.4054928 0.343147081 0.39367423
Item11       12      13 0.64418187 0.6145304 0.7000521 0.672690792 0.69786842
Item12       12      13 0.67703722 0.6501237 0.7328359 0.708570676 0.73098832
Item13       12      13 0.55118913 0.5137882 0.6059746 0.569573925 0.60268362
Item14       12      13 0.71612999 0.6924742 0.7851440 0.765354974 0.78340459
Item15       12      13 0.61823375 0.5864199 0.7063782 0.678084931 0.70284763
            RMSEA       AIC      CAIC       BIC
Item01 0.07609076 22.669348 -27.92993 -27.90595
Item02 0.06191431 10.954288 -39.64499 -39.62101
Item03 0.06881135 16.353194 -34.24608 -34.22210
Item04 0.05097326  3.558459 -47.04081 -47.01684
Item05 0.08077566 27.069950 -23.52932 -23.50535
Item06 0.06835787 15.980720 -34.61855 -34.59458
Item07 0.07680154 23.320078 -27.27920 -27.25522
Item08 0.06966050 17.057277 -33.54200 -33.51802
Item09 0.08007866 26.398598 -24.20067 -24.17670
Item10 0.07136866 18.499790 -32.09948 -32.07551
Item11 0.08325047 29.500673 -21.09860 -21.07462
Item12 0.08059965 26.899864 -23.69941 -23.67543
Item13 0.08913117 35.570864 -15.02841 -15.00443
Item14 0.06684217 14.753641 -35.84563 -35.82166
Item15 0.06424256 12.713116 -37.88616 -37.86218</code></pre>
</div>
</div>
</section>
<section id="可視化しましょう" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="可視化しましょう"><span class="header-section-number">4.3.3</span> 可視化しましょう</h3>
<ul>
<li>項目反応関数(IRF)を表示してみましょう
<ul>
<li>表示させたい項目を<code>items</code>オプションで与えます</li>
<li>表示させたい図の種類を<code>type</code>オプションで指定します
<ul>
<li><code>IRF</code>,<code>TRF</code>,<code>IIC</code>,<code>TIC</code>を選ぶことができます。</li>
<li><code>ICC</code>(Item Characteristic Curve)も可(<code>IRF</code>と同じです)</li>
</ul></li>
<li>指定しなければ全ての項目をプロットします</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">items =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"IRF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>項目反応関数(IRF)を表示してみましょう
<ul>
<li>複数の項目を一気に表示するには，<code>overlay</code>オプションを<code>TRUE</code>にするか，配置の行列指定(次頁)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">type =</span> <span class="st">"IRF"</span>, <span class="at">overlay =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>項目反応関数(IRF)を表示してみましょう
<ul>
<li>複数の項目を一気に表示するには，<code>overlay</code>オプションを<code>TRUE</code>にするか，配置の行列指定
<ul>
<li><code>nr</code>で行数，<code>nc</code>で列数を指定できます</li>
</ul></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">type =</span> <span class="st">"IRF"</span>, <span class="at">nr =</span> <span class="dv">3</span>, <span class="at">nc =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>テスト反応関数(TRF)を表示してみましょう
<ul>
<li><code>type=IRF</code>として，<code>items =0</code>としても同様の出力を得ます</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"TRF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, type = "IRF", items = 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>項目情報関数(IIF)を表示してみましょう</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">type =</span> <span class="st">"IIF"</span>, <span class="at">overlay =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>テスト情報関数(TIF)を表示してみましょう</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">type =</span> <span class="st">"TIF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(result, items = 0, type = "IIF")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="受検者の情報も含まれています" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="受検者の情報も含まれています"><span class="header-section-number">4.3.4</span> 受検者の情報も含まれています</h3>
<ul>
<li>EAP(Expectation A Posterior)推定値を出力します</li>
<li>PSD(Posterior Standard Deviation)も出力します</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>ability <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ID         EAP       PSD
1  Student001 -0.66456785 0.5457047
2  Student002 -0.14853705 0.5626979
3  Student003  0.01362530 0.5699764
4  Student004  0.58775681 0.6012839
5  Student005 -0.97796879 0.5415527
6  Student006  0.85892500 0.6187224
7  Student007  0.05696151 0.5720482
8  Student008  0.04790635 0.5716114
9  Student009  1.23035682 0.6433918
10 Student010 -0.19705227 0.5606753
11 Student011 -0.34067171 0.5551509
12 Student012 -0.51385232 0.5495270
13 Student013  1.05114793 0.6316587
14 Student014  0.81625131 0.6158908
15 Student015 -1.35345903 0.5440715
16 Student016 -1.53285015 0.5476038
17 Student017  0.62954570 0.6038740
18 Student018 -0.96955169 0.5415908
19 Student019  0.73791239 0.6107655
20 Student020 -0.80866482 0.5431159</code></pre>
</div>
</div>
</section>
<section id="q3行列" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="q3行列"><span class="header-section-number">4.3.5</span> Q3行列</h3>
<ul>
<li>局所独立の仮定が満たされているかどうかを判断する指標として，Q3行列があります
<ul>
<li>項目特性同士の相関行列です</li>
<li>この値が高すぎると局所独立の仮定が満たされていない可能性があります</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>Q3mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Item01  Item02   Item03   Item04   Item05   Item06   Item07  Item08
Item01  1.0000 -0.0535 -0.08856 -0.13197  0.05521  0.01128 -0.09982  0.0139
Item02 -0.0535  1.0000  0.00440 -0.02750 -0.02981 -0.03641 -0.10196 -0.0638
Item03 -0.0886  0.0044  1.00000  0.00363  0.00902  0.00334  0.01898 -0.0465
Item04 -0.1320 -0.0275  0.00363  1.00000 -0.08089 -0.12016 -0.03221 -0.0855
Item05  0.0552 -0.0298  0.00902 -0.08089  1.00000 -0.06635 -0.04430 -0.0596
Item06  0.0113 -0.0364  0.00334 -0.12016 -0.06635  1.00000 -0.02694  0.0255
Item07 -0.0998 -0.1020  0.01898 -0.03221 -0.04430 -0.02694  1.00000 -0.0245
Item08  0.0139 -0.0638 -0.04653 -0.08547 -0.05961  0.02546 -0.02450  1.0000
Item09  0.0191 -0.0541 -0.03816 -0.05523 -0.08799 -0.07573 -0.01889 -0.0744
Item10 -0.0392 -0.0409 -0.02099 -0.09241 -0.01727 -0.02101  0.00508 -0.0625
Item11 -0.0281 -0.0171 -0.07191 -0.07304 -0.05427 -0.10232 -0.06882  0.0049
Item12 -0.0683 -0.0562 -0.07754 -0.01098 -0.06810 -0.09014 -0.07219 -0.0672
Item13 -0.0342 -0.0820 -0.01490 -0.07015  0.02738 -0.08209 -0.10070 -0.0297
Item14 -0.0209 -0.0496 -0.11632 -0.16292 -0.04666 -0.02432 -0.15965 -0.1019
Item15 -0.0343 -0.0436 -0.07199 -0.03444 -0.05169  0.03602 -0.05857 -0.0781
         Item09   Item10   Item11  Item12   Item13   Item14  Item15
Item01  0.01906 -0.03915 -0.02813 -0.0683 -0.03423 -0.02090 -0.0343
Item02 -0.05412 -0.04094 -0.01708 -0.0562 -0.08200 -0.04963 -0.0436
Item03 -0.03816 -0.02099 -0.07191 -0.0775 -0.01490 -0.11632 -0.0720
Item04 -0.05523 -0.09241 -0.07304 -0.0110 -0.07015 -0.16292 -0.0344
Item05 -0.08799 -0.01727 -0.05427 -0.0681  0.02738 -0.04666 -0.0517
Item06 -0.07573 -0.02101 -0.10232 -0.0901 -0.08209 -0.02432  0.0360
Item07 -0.01889  0.00508 -0.06882 -0.0722 -0.10070 -0.15965 -0.0586
Item08 -0.07436 -0.06251  0.00490 -0.0672 -0.02972 -0.10189 -0.0781
Item09  1.00000 -0.10174 -0.05357  0.0772 -0.00977  0.01932 -0.0708
Item10 -0.10174  1.00000 -0.02597 -0.0902  0.01259  0.02296 -0.0529
Item11 -0.05357 -0.02597  1.00000 -0.0630 -0.15170  0.00762 -0.0948
Item12  0.07724 -0.09020 -0.06302  1.0000 -0.09172 -0.05197 -0.0887
Item13 -0.00977  0.01259 -0.15170 -0.0917  1.00000 -0.03881  0.0113
Item14  0.01932  0.02296  0.00762 -0.0520 -0.03881  1.00000 -0.0680
Item15 -0.07085 -0.05290 -0.09481 -0.0887  0.01128 -0.06801  1.0000</code></pre>
</div>
</div>
</section>
</section>
<section id="多値への展開" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="多値への展開"><span class="header-section-number">4.4</span> 多値への展開</h2>
<section id="段階反応モデル" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="段階反応モデル"><span class="header-section-number">4.4.1</span> 段階反応モデル</h3>
<ul>
<li>段階反応モデルは順序的な反応段階を仮定したモデルです
<ul>
<li>K段階カテゴリのデータがあったとして，k以上のカテゴリに反応する確率を2PLモデルのように推定します。</li>
</ul></li>
<li>サンプルデータ<code>J5S1000</code>で様子を見てみましょう</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> J5S1000</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TestStatistics</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Statistics
                   value
SampleSize 1000.00000000
TestLength    5.00000000
Median       12.00000000
Max          18.00000000
Min           4.00000000
Range        14.00000000
Mean         11.45700000
SD            2.92107578
Skewness     -0.08836075
Kurtosis     -0.55776379
Alpha         0.59462241</code></pre>
</div>
</div>
<ul>
<li><code>exametrika</code>の性能(精度＋実行速度)はそこまで高くないので、<code>ltm</code>パッケージや<code>mirt</code>パッケージなども参考にしてください。</li>
<li></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>result.GRM <span class="ot">&lt;-</span> <span class="fu">GRM</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 6497.015125 
iter  10 value 6046.073326
iter  20 value 6013.787923
iter  30 value 6008.297277
final  value 6008.297277 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>result.GRM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Item Parameter
   Descriminate Threshold1 Threshold2 Threshold3
V1        0.927      -1.54     0.0512       1.53
V2        1.234      -1.21     1.3936         NA
V3        0.917      -1.60    -0.0757       1.27
V4        1.479      -1.44     1.3166         NA
V5        0.947      -1.37     0.0286       1.54

Item Fit Indices
     NFI   RFI   IFI   TLI   CFI RMSEA     AIC    CAIC     BIC
V1 0.248 0.265 0.271 0.288 0.272 0.090 324.819  99.017  99.063
V2 0.219 0.244 0.236 0.263 0.238 0.098 263.864 111.692 111.723
V3 0.253 0.269 0.276 0.293 0.277 0.089 321.824  96.021  96.067
V4 0.000 0.000 0.000 0.000 0.000 0.132 512.023 359.852 359.883
V5 0.255 0.272 0.278 0.295 0.279 0.090 327.598 101.795 101.841

Model Fit Indices
         value
NFI      0.165
RFI      0.186
IFI      0.179
TLI      0.201
CFI      0.180
RMSEA    0.099
AIC   1750.128
CAIC   768.377
BIC    768.577</code></pre>
</div>
</div>
</section>
<section id="可視化しましょう-1" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="可視化しましょう-1"><span class="header-section-number">4.4.2</span> 可視化しましょう</h3>
<ul>
<li>IRTモデルと同じように，IRFを出力することができます。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.GRM, <span class="at">type =</span> <span class="st">"IRF"</span>, <span class="at">items =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.GRM, <span class="at">type =</span> <span class="st">"IRF"</span>, <span class="at">items =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>IRTモデルと同じように，IIFを出力することができます。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.GRM, <span class="at">type =</span> <span class="st">"IIF"</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>IRTモデルと同じように，TIFを出力することができます。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.GRM, <span class="at">type =</span> <span class="st">"TIF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap4_IRT_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="コラムgrmと他のモデル" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="コラムgrmと他のモデル"><span class="header-section-number">4.5</span> コラム：GRMと他のモデル</h2>
<ul>
<li>段階反応モデルは正規分布する連続的潜在変数<span class="math inline">\(\theta\)</span>を仮定して，数値が高くなるとより上位のカテゴリに反応しやすくなるモデルです。
<ul>
<li>社会的態度を測定するリッカート法のIRT版とも言えます</li>
<li>反応カテゴリに順序性を仮定した因子分析と数学的に等価です</li>
<li>カテゴリ反応で多因子モデルの場合，<code>mirt</code>パッケージ(Multidimensional IRT)や<code>lavaan</code>パッケージ(LAtent VAriable ANalysis)で推定しましょう</li>
</ul></li>
<li>IRFを見ることで，項目カテゴリが反応段階を弁別できているかチェックできます</li>
</ul>
</section>
<section id="コラム態度測定論" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="コラム態度測定論"><span class="header-section-number">4.6</span> コラム：態度測定論</h2>
<ul>
<li><strong>社会的態度</strong>は社会心理学の分野で考えられてきた連続的潜在変数です
<ul>
<li>サーストンの考えた測定方法(等現間隔法)をつかって測定する，一次元モデルです</li>
<li>リッカートの方法はサーストン法の簡易版として出てきた態度モデルです</li>
</ul></li>
<li>昨今は，「心の測定」，「心理学的連続体」，「心理尺度の妥当性」が問題になっています</li>
<li>心理尺度(リッカート法)は一朝一夕に作れるものではありません</li>
<li>心理尺度は領域，方法，標準化など使用法によく注意して利用しましょう</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap2_ItemTest.html" class="pagination-link" aria-label="Rをつかった項目分析の実習">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Rをつかった項目分析の実習</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap6_LRA.html" class="pagination-link" aria-label="Rをつかった潜在クラス/ランク分析の実習">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rをつかった潜在クラス/ランク分析の実習</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>