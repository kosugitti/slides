<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; 潜在クラス / ランク分析 – exametrikaパッケージ チュートリアル</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chap05_Biclustering.html" rel="next">
<link href="./chap03_IRT.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap04_LCA_LRA.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">潜在クラス / ランク分析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">exametrikaパッケージ チュートリアル</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">はじめに</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap01_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">データ準備</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap02_descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">記述統計・項目分析・CTT</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap03_IRT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">項目反応理論</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap04_LCA_LRA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">潜在クラス / ランク分析</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap05_Biclustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">バイクラスタリング</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap06_BNM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ベイズネットワークモデル</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap07_LDLRA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">局所依存モデルとBINET</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#潜在クラス分析lca" id="toc-潜在クラス分析lca" class="nav-link active" data-scroll-target="#潜在クラス分析lca"><span class="header-section-number">5.1</span> 潜在クラス分析（LCA）</a>
  <ul class="collapse">
  <li><a href="#受検者情報" id="toc-受検者情報" class="nav-link" data-scroll-target="#受検者情報"><span class="header-section-number">5.1.1</span> 受検者情報</a></li>
  <li><a href="#項目参照プロファイルirp" id="toc-項目参照プロファイルirp" class="nav-link" data-scroll-target="#項目参照プロファイルirp"><span class="header-section-number">5.1.2</span> 項目参照プロファイル（IRP）</a></li>
  <li><a href="#可視化baseグラフィックス" id="toc-可視化baseグラフィックス" class="nav-link" data-scroll-target="#可視化baseグラフィックス"><span class="header-section-number">5.1.3</span> 可視化（baseグラフィックス）</a></li>
  <li><a href="#可視化ggexametrika" id="toc-可視化ggexametrika" class="nav-link" data-scroll-target="#可視化ggexametrika"><span class="header-section-number">5.1.4</span> 可視化（ggExametrika）</a></li>
  </ul></li>
  <li><a href="#潜在ランク分析lra" id="toc-潜在ランク分析lra" class="nav-link" data-scroll-target="#潜在ランク分析lra"><span class="header-section-number">5.2</span> 潜在ランク分析（LRA）</a>
  <ul class="collapse">
  <li><a href="#受検者情報-1" id="toc-受検者情報-1" class="nav-link" data-scroll-target="#受検者情報-1"><span class="header-section-number">5.2.1</span> 受検者情報</a></li>
  <li><a href="#項目参照プロファイルirp-1" id="toc-項目参照プロファイルirp-1" class="nav-link" data-scroll-target="#項目参照プロファイルirp-1"><span class="header-section-number">5.2.2</span> 項目参照プロファイル（IRP）</a></li>
  <li><a href="#irpindex" id="toc-irpindex" class="nav-link" data-scroll-target="#irpindex"><span class="header-section-number">5.2.3</span> IRPIndex</a></li>
  <li><a href="#可視化baseグラフィックス-1" id="toc-可視化baseグラフィックス-1" class="nav-link" data-scroll-target="#可視化baseグラフィックス-1"><span class="header-section-number">5.2.4</span> 可視化（baseグラフィックス）</a></li>
  <li><a href="#可視化ggexametrika-1" id="toc-可視化ggexametrika-1" class="nav-link" data-scroll-target="#可視化ggexametrika-1"><span class="header-section-number">5.2.5</span> 可視化（ggExametrika）</a></li>
  </ul></li>
  <li><a href="#推定法の選択gtm-vs-som" id="toc-推定法の選択gtm-vs-som" class="nav-link" data-scroll-target="#推定法の選択gtm-vs-som"><span class="header-section-number">5.3</span> 推定法の選択：GTM vs SOM</a>
  <ul class="collapse">
  <li><a href="#gtmgenerative-topographic-mapping" id="toc-gtmgenerative-topographic-mapping" class="nav-link" data-scroll-target="#gtmgenerative-topographic-mapping"><span class="header-section-number">5.3.1</span> GTM（Generative Topographic Mapping）</a></li>
  <li><a href="#somself-organizing-map" id="toc-somself-organizing-map" class="nav-link" data-scroll-target="#somself-organizing-map"><span class="header-section-number">5.3.2</span> SOM（Self-Organizing Map）</a></li>
  <li><a href="#結果の比較" id="toc-結果の比較" class="nav-link" data-scroll-target="#結果の比較"><span class="header-section-number">5.3.3</span> 結果の比較</a></li>
  </ul></li>
  <li><a href="#多値データへの展開" id="toc-多値データへの展開" class="nav-link" data-scroll-target="#多値データへの展開"><span class="header-section-number">5.4</span> 多値データへの展開</a>
  <ul class="collapse">
  <li><a href="#多肢選択ratedデータ" id="toc-多肢選択ratedデータ" class="nav-link" data-scroll-target="#多肢選択ratedデータ"><span class="header-section-number">5.4.1</span> 多肢選択（rated）データ</a></li>
  <li><a href="#順序データ" id="toc-順序データ" class="nav-link" data-scroll-target="#順序データ"><span class="header-section-number">5.4.2</span> 順序データ</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">潜在クラス / ランク分析</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>この章では，潜在クラス分析（LCA）と潜在ランク分析（LRA）を紹介します。サンプルデータ<code>J15S500</code>（15項目・500人の二値データ）を使用します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> J15S500</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TestStatistics</span>(dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test Statistics
                  value
TestLength   15.0000000
SampleSize  500.0000000
Mean          9.6640000
SEofMean      0.1190738
Variance      7.0892826
SD            2.6625707
Skewness     -0.4116220
Kurtosis     -0.4471624
Min           2.0000000
Max          15.0000000
Range        13.0000000
Q1.25%        8.0000000
Median.50%   10.0000000
Q3.75%       12.0000000
IQR           4.0000000
Stanine.4%    5.0000000
Stanine.11%   6.0000000
Stanine.23%   7.0000000
Stanine.40%   9.0000000
Stanine.60%  11.0000000
Stanine.77%  12.0000000
Stanine.89%  13.0000000
Stanine.96%  14.0000000</code></pre>
</div>
</div>
<section id="潜在クラス分析lca" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="潜在クラス分析lca"><span class="header-section-number">5.1</span> 潜在クラス分析（LCA）</h2>
<p>潜在クラス分析は，受検者を潜在的なグループに分類するモデルです。<code>ncls</code>引数でクラス数を指定します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>result.LCA <span class="ot">&lt;-</span> <span class="fu">LCA</span>(dat, <span class="at">ncls =</span> <span class="dv">6</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>result.LCA</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Item Reference Profile
         IRP1   IRP2    IRP3  IRP4   IRP5  IRP6
Item01 0.4370 0.7608 0.73618 0.789 0.8459 0.883
Item02 0.5916 0.4784 0.75372 0.990 0.8738 0.805
Item03 0.7695 0.4027 0.89807 0.673 0.7384 0.855
Item04 0.5757 0.3974 0.87205 0.883 0.8866 1.000
Item05 0.6023 0.7820 0.94283 0.797 0.7931 0.883
Item06 0.6508 0.7042 0.92835 0.988 1.0000 0.881
Item07 0.5395 0.3102 0.82178 0.757 0.9169 0.910
Item08 0.3767 0.3255 0.60377 0.670 0.8828 0.635
Item09 0.2945 0.3467 0.16135 0.636 0.0107 0.739
Item10 0.5200 0.5570 0.79602 0.552 0.7070 0.819
Item11 0.1053 0.0472 0.00488 0.208 0.6864 0.656
Item12 0.0729 0.0776 0.16864 0.244 0.3015 0.764
Item13 0.2142 0.4370 0.95899 0.649 0.6426 0.842
Item14 0.2379 0.7530 0.76640 0.874 0.9085 1.000
Item15 0.3935 0.5389 0.86050 0.717 0.8220 0.863

Test Profile
                              Class 1 Class 2 Class 3 Class 4 Class 5 Class 6
Test Reference Profile          6.381   6.919  10.274  10.428  11.016  12.535
Latent Class Ditribution       76.000  74.000 105.000  82.000  91.000  72.000
Class Membership Distribution  77.345  80.034  88.778  85.807  84.592  83.444

Item Fit Indices
       model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
Item01       -258.896       -240.190      -283.343       37.414      86.307
Item02       -235.421       -235.436      -278.949       -0.032      87.025
Item03       -262.373       -260.906      -293.598        2.934      65.383
Item04       -201.256       -192.072      -265.962       18.369     147.780
Item05       -230.005       -206.537      -247.403       46.935      81.732
Item06       -157.551       -153.940      -198.817        7.223      89.755
Item07       -241.548       -228.379      -298.345       26.338     139.933
Item08       -301.042       -293.225      -338.789       15.634      91.127
Item09       -246.942       -300.492      -327.842     -107.100      54.700
Item10       -303.019       -288.198      -319.850       29.641      63.303
Item11       -194.120       -224.085      -299.265      -59.931     150.360
Item12       -227.324       -214.797      -293.598       25.054     157.603
Item13       -257.389       -262.031      -328.396       -9.282     132.730
Item14       -193.802       -204.953      -273.212      -22.302     136.519
Item15       -267.063       -254.764      -302.847       24.598      96.166
       model_df null_df   NFI   RFI   IFI   TLI   CFI RMSEA      AIC     CAIC
Item01        8      13 0.567 0.296 0.624 0.348 0.599 0.086   21.414  -20.303
Item02        8      13 1.000 1.000 1.000 1.000 1.000 0.000  -16.032  -57.749
Item03        8      13 0.955 0.927 1.000 1.000 1.000 0.000  -13.066  -54.783
Item04        8      13 0.876 0.798 0.926 0.875 0.923 0.051    2.369  -39.348
Item05        8      13 0.426 0.067 0.472 0.079 0.434 0.099   30.935  -10.782
Item06        8      13 0.920 0.869 1.000 1.000 1.000 0.000   -8.777  -50.494
Item07        8      13 0.812 0.694 0.861 0.765 0.856 0.068   10.338  -31.379
Item08        8      13 0.828 0.721 0.908 0.841 0.902 0.044   -0.366  -42.083
Item09        8      13 1.000 1.000 1.000 1.000 1.000 0.000 -123.100 -164.817
Item10        8      13 0.532 0.239 0.609 0.301 0.570 0.074   13.641  -28.076
Item11        8      13 1.000 1.000 1.000 1.000 1.000 0.000  -75.931 -117.648
Item12        8      13 0.841 0.742 0.886 0.808 0.882 0.065    9.054  -32.663
Item13        8      13 1.000 1.000 1.000 1.000 1.000 0.000  -25.282  -66.999
Item14        8      13 1.000 1.000 1.000 1.000 1.000 0.000  -38.302  -80.019
Item15        8      13 0.744 0.584 0.812 0.676 0.800 0.064    8.598  -33.119
            BIC
Item01  -12.303
Item02  -49.749
Item03  -46.783
Item04  -31.348
Item05   -2.782
Item06  -42.494
Item07  -23.379
Item08  -34.083
Item09 -156.817
Item10  -20.076
Item11 -109.648
Item12  -24.663
Item13  -58.999
Item14  -72.019
Item15  -25.119

Model Fit Indices
Number of Latent class: 6
Number of EM cycle: 75 
                   value
model_log_like -3577.752
bench_log_like -3560.005
null_log_like  -4350.217
model_Chi_sq      35.494
null_Chi_sq     1580.424
model_df         120.000
null_df          195.000
NFI                0.978
RFI                0.964
IFI                1.000
TLI                1.000
CFI                1.000
RMSEA              0.000
AIC             -204.506
CAIC            -830.259
BIC             -710.259</code></pre>
</div>
</div>
<section id="受検者情報" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="受検者情報"><span class="header-section-number">5.1.1</span> 受検者情報</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>result.LCA<span class="sc">$</span>Students <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Membership 1 Membership 2 Membership 3 Membership 4 Membership 5
Student001 0.7260153212 0.1695828123 0.0191959227  0.048856576 3.634937e-02
Student002 0.0289874633 0.0254959545 0.8260430686  0.079770428 3.970303e-02
Student003 0.0064609145 0.0694589721 0.7665502806  0.118988645 2.246314e-02
Student004 0.0022440776 0.0037648933 0.1986288018  0.338531342 3.159317e-01
Student005 0.1089417615 0.8873608716 0.0008618367  0.002630128 3.770563e-08
Student006 0.0002507583 0.0002997263 0.0034460370  0.080211142 8.556562e-01
           Membership 6 Estimate
Student001 1.643797e-12        1
Student002 5.150005e-08        3
Student003 1.607805e-02        3
Student004 1.408992e-01        4
Student005 2.053643e-04        2
Student006 6.013617e-02        5</code></pre>
</div>
</div>
</section>
<section id="項目参照プロファイルirp" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="項目参照プロファイルirp"><span class="header-section-number">5.1.2</span> 項目参照プロファイル（IRP）</h3>
<p>項目ごと・クラスごとの正答率を示します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>result.LCA<span class="sc">$</span>IRP</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             IRP1       IRP2        IRP3      IRP4       IRP5      IRP6
Item01 0.43697714 0.76082606 0.736182286 0.7888704 0.84587512 0.8833284
Item02 0.59162865 0.47842615 0.753719163 0.9895872 0.87381506 0.8053917
Item03 0.76947911 0.40266981 0.898069972 0.6729179 0.73839500 0.8547668
Item04 0.57568548 0.39740342 0.872051963 0.8834114 0.88663263 0.9999987
Item05 0.60228148 0.78201881 0.942825081 0.7970466 0.79313086 0.8825286
Item06 0.65081695 0.70419410 0.928346145 0.9880396 0.99999819 0.8809962
Item07 0.53954860 0.31021765 0.821782975 0.7573892 0.91694500 0.9099388
Item08 0.37665418 0.32548664 0.603770254 0.6703679 0.88279332 0.6353566
Item09 0.29449208 0.34671215 0.161352112 0.6363038 0.01069097 0.7387628
Item10 0.51999141 0.55701126 0.796021391 0.5519760 0.70703883 0.8192215
Item11 0.10527790 0.04723862 0.004876396 0.2075675 0.68644801 0.6563071
Item12 0.07286478 0.07761944 0.168639693 0.2437380 0.30148250 0.7641428
Item13 0.21415120 0.43700977 0.958994723 0.6494997 0.64262783 0.8416495
Item14 0.23788534 0.75296124 0.766397233 0.8740889 0.90850482 0.9999995
Item15 0.39351809 0.53891044 0.860504438 0.7168047 0.82195096 0.8628674</code></pre>
</div>
</div>
</section>
<section id="可視化baseグラフィックス" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="可視化baseグラフィックス"><span class="header-section-number">5.1.3</span> 可視化（baseグラフィックス）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LCA, <span class="at">type =</span> <span class="st">"IRP"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>クラスメンバーシッププロファイル（CMP）は，受検者がどのクラスに所属しやすいかの確率を表します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LCA, <span class="at">type =</span> <span class="st">"CMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>テスト参照プロファイル（TRP）は，テスト得点とクラスの分類を可視化します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LCA, <span class="at">type =</span> <span class="st">"TRP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>潜在クラス分布（LCD）は，クラスの分布を表示します。棒グラフがLatent Class Distribution，折れ線グラフがClass Membership Distributionです。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LCA, <span class="at">type =</span> <span class="st">"LCD"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="可視化ggexametrika" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="可視化ggexametrika"><span class="header-section-number">5.1.4</span> 可視化（ggExametrika）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExametrika)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotIRP_gg</span>(result.LCA)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCMP_gg</span>(result.LCA)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotTRP_gg</span>(result.LCA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotLCD_gg</span>(result.LCA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="潜在ランク分析lra" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="潜在ランク分析lra"><span class="header-section-number">5.2</span> 潜在ランク分析（LRA）</h2>
<p>LCAの潜在クラスに序列性を持たせたものが潜在ランク分析（LRA）です。<code>nrank</code>引数でランク数を指定し，<code>mic = TRUE</code>で単調増加制約を課します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>result.LRA <span class="ot">&lt;-</span> <span class="fu">LRA</span>(dat, <span class="at">nrank =</span> <span class="dv">6</span>, <span class="at">mic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>result.LRA</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>estimating method is  GTM 

 Monotonic increasing IRP option is TRUE.
Item Reference Profile
         IRP1   IRP2  IRP3  IRP4  IRP5  IRP6
Item01 0.5813 0.6370 0.711 0.780 0.849 0.901
Item02 0.5257 0.6280 0.754 0.837 0.879 0.883
Item03 0.6112 0.6127 0.702 0.768 0.807 0.839
Item04 0.4415 0.5963 0.790 0.889 0.943 0.972
Item05 0.6481 0.7458 0.816 0.829 0.864 0.911
Item06 0.6476 0.7794 0.913 0.937 0.948 0.951
Item07 0.4078 0.5103 0.717 0.841 0.891 0.902
Item08 0.3332 0.4315 0.605 0.702 0.717 0.721
Item09 0.3154 0.3179 0.322 0.334 0.380 0.503
Item10 0.5043 0.5783 0.681 0.724 0.728 0.745
Item11 0.0882 0.0922 0.138 0.274 0.466 0.621
Item12 0.0622 0.0959 0.159 0.253 0.422 0.616
Item13 0.2875 0.4833 0.710 0.766 0.769 0.771
Item14 0.4780 0.6005 0.732 0.844 0.930 0.975
Item15 0.4044 0.5671 0.751 0.824 0.835 0.838

Item Reference Profile Indices
       Alpha      A Beta     B Gamma C
Item01     2 0.0735    1 0.581     0 0
Item02     2 0.1264    1 0.526     0 0
Item03     2 0.0893    1 0.611     0 0
Item04     2 0.1935    1 0.442     0 0
Item05     1 0.0977    1 0.648     0 0
Item06     2 0.1331    1 0.648     0 0
Item07     2 0.2069    2 0.510     0 0
Item08     2 0.1734    2 0.431     0 0
Item09     5 0.1231    6 0.503     0 0
Item10     2 0.1027    1 0.504     0 0
Item11     4 0.1911    5 0.466     0 0
Item12     5 0.1939    5 0.422     0 0
Item13     2 0.2264    2 0.483     0 0
Item14     2 0.1316    1 0.478     0 0
Item15     2 0.1837    2 0.567     0 0

Test Profile
                             Rank 1 Rank 2 Rank 3 Rank 4 Rank 5  Rank 6
Test Reference Profile        6.336  7.676  9.499 10.603 11.426  12.149
Latent Rank Ditribution      97.000 56.000 90.000 89.000 65.000 103.000
Rank Membership Distribution 83.037 77.984 81.981 84.777 84.710  87.511

Item Fit Indices
       model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
Item01       -264.521       -240.190      -283.343       48.662      86.307
Item02       -253.391       -235.436      -278.949       35.909      87.025
Item03       -282.696       -260.906      -293.598       43.580      65.383
Item04       -206.656       -192.072      -265.962       29.169     147.780
Item05       -234.649       -206.537      -247.403       56.224      81.732
Item06       -172.010       -153.940      -198.817       36.141      89.755
Item07       -249.856       -228.379      -298.345       42.954     139.933
Item08       -312.980       -293.225      -338.789       39.510      91.127
Item09       -322.072       -300.492      -327.842       43.159      54.700
Item10       -310.319       -288.198      -319.850       44.240      63.303
Item11       -243.621       -224.085      -299.265       39.071     150.360
Item12       -239.220       -214.797      -293.598       48.847     157.603
Item13       -287.805       -262.031      -328.396       51.549     132.730
Item14       -222.496       -204.953      -273.212       35.086     136.519
Item15       -268.522       -254.764      -302.847       27.518      96.166
       model_df null_df   NFI   RFI   IFI   TLI   CFI RMSEA    AIC    CAIC
Item01    9.233      13 0.436 0.206 0.488 0.243 0.462 0.093 30.197 -17.948
Item02    9.233      13 0.587 0.419 0.657 0.493 0.640 0.076 17.443 -30.702
Item03    9.233      13 0.333 0.062 0.388 0.077 0.344 0.086 25.114 -23.031
Item04    9.233      13 0.803 0.722 0.856 0.792 0.852 0.066 10.704 -37.441
Item05    9.233      13 0.312 0.031 0.352 0.037 0.316 0.101 37.758 -10.387
Item06    9.233      13 0.597 0.433 0.666 0.506 0.649 0.076 17.676 -30.469
Item07    9.233      13 0.693 0.568 0.742 0.626 0.734 0.086 24.489 -23.656
Item08    9.233      13 0.566 0.390 0.630 0.454 0.612 0.081 21.044 -27.101
Item09    9.233      13 0.211 0.000 0.254 0.000 0.186 0.086 24.694 -23.451
Item10    9.233      13 0.301 0.016 0.353 0.020 0.304 0.087 25.775 -22.370
Item11    9.233      13 0.740 0.634 0.789 0.694 0.783 0.080 20.606 -27.539
Item12    9.233      13 0.690 0.564 0.733 0.614 0.726 0.093 30.382 -17.763
Item13    9.233      13 0.612 0.453 0.657 0.502 0.647 0.096 33.084 -15.062
Item14    9.233      13 0.743 0.638 0.797 0.705 0.791 0.075 16.621 -31.524
Item15    9.233      13 0.714 0.597 0.790 0.690 0.780 0.063  9.052 -39.093
           BIC
Item01  -8.716
Item02 -21.469
Item03 -13.798
Item04 -28.209
Item05  -1.154
Item06 -21.236
Item07 -14.424
Item08 -17.868
Item09 -14.219
Item10 -13.137
Item11 -18.307
Item12  -8.531
Item13  -5.829
Item14 -22.292
Item15 -29.860

Model Fit Indices
Number of Latent rank: 6
Number of EM cycle: 13 
                   value
model_log_like -3870.815
bench_log_like -3560.005
null_log_like  -4350.217
model_Chi_sq     621.620
null_Chi_sq     1580.424
model_df         138.491
null_df          195.000
NFI                0.607
RFI                0.446
IFI                0.665
TLI                0.509
CFI                0.651
RMSEA              0.084
AIC              344.638
CAIC            -377.538
BIC             -239.047</code></pre>
</div>
</div>
<section id="受検者情報-1" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="受検者情報-1"><span class="header-section-number">5.2.1</span> 受検者情報</h3>
<p>Rank-Up OddsやRank-Down Oddsが表示され，上のランクへの上がりやすさ・下のランクへの落ちやすさを示します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>result.LRA<span class="sc">$</span>Students <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Membership 1 Membership 2 Membership 3 Membership 4 Membership 5
Student001 0.2649442154  0.401777727   0.25199194  0.069833913  0.010587063
Student002 0.0320802124  0.165197013   0.47017520  0.262193334  0.061017540
Student003 0.0256087173  0.143643145   0.36931821  0.263791224  0.137653365
Student004 0.0019080554  0.015030869   0.09499327  0.201622664  0.343207280
Student005 0.5745639230  0.379140089   0.03754276  0.006239969  0.001910557
Student006 0.0003651887  0.003620252   0.04607054  0.202440568  0.398545000
           Membership 6 Estimate Rank-Up Odds Rank-Down Odds
Student001 0.0008651363        2    0.6271924      0.6594298
Student002 0.0093367003        3    0.5576503      0.3513520
Student003 0.0599853347        3    0.7142654      0.3889414
Student004 0.3432378584        6           NA      0.9999109
Student005 0.0006027066        1    0.6598745             NA
Student006 0.3489584503        5    0.8755811      0.5079491</code></pre>
</div>
</div>
</section>
<section id="項目参照プロファイルirp-1" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="項目参照プロファイルirp-1"><span class="header-section-number">5.2.2</span> 項目参照プロファイル（IRP）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>result.LRA<span class="sc">$</span>IRP</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             IRP1       IRP2      IRP3      IRP4      IRP5      IRP6
Item01 0.58134579 0.63703070 0.7105624 0.7799727 0.8488455 0.9005402
Item02 0.52566747 0.62802753 0.7544298 0.8369062 0.8793933 0.8828570
Item03 0.61116426 0.61266166 0.7019998 0.7679128 0.8071646 0.8391724
Item04 0.44152626 0.59634830 0.7898921 0.8885698 0.9427475 0.9724996
Item05 0.64810054 0.74581736 0.8158043 0.8292063 0.8635791 0.9113865
Item06 0.64762411 0.77943717 0.9125559 0.9366776 0.9476421 0.9507004
Item07 0.40777315 0.51032060 0.7172665 0.8414449 0.8909572 0.9019490
Item08 0.33320297 0.43146180 0.6048313 0.7022176 0.7165168 0.7207851
Item09 0.31536164 0.31793335 0.3215534 0.3337615 0.3799428 0.5030880
Item10 0.50433135 0.57829599 0.6809487 0.7244593 0.7284557 0.7447081
Item11 0.08816694 0.09217932 0.1376948 0.2744389 0.4655814 0.6209129
Item12 0.06219226 0.09589473 0.1590574 0.2528391 0.4223461 0.6162779
Item13 0.28748283 0.48325773 0.7096872 0.7658707 0.7689499 0.7711838
Item14 0.47797956 0.60051446 0.7321160 0.8442909 0.9295404 0.9747505
Item15 0.40437730 0.56707341 0.7507473 0.8243016 0.8346267 0.8378010</code></pre>
</div>
</div>
</section>
<section id="irpindex" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="irpindex"><span class="header-section-number">5.2.3</span> IRPIndex</h3>
<p>IRPの要約指標として，以下の3つのインデックスが算出されます。</p>
<ul>
<li><strong>A（Item Slope Index）</strong>：識別力に相当する指標</li>
<li><strong>B（Item Location Index）</strong>：困難度に相当する指標</li>
<li><strong>C（Item Monotonicity Index）</strong>：単調増加性の指標</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>result.LRA<span class="sc">$</span>IRPIndex</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Alpha          A Beta         B Gamma C
Item01     2 0.07353170    1 0.5813458     0 0
Item02     2 0.12640232    1 0.5256675     0 0
Item03     2 0.08933814    1 0.6111643     0 0
Item04     2 0.19354385    1 0.4415263     0 0
Item05     1 0.09771682    1 0.6481005     0 0
Item06     2 0.13311875    1 0.6476241     0 0
Item07     2 0.20694595    2 0.5103206     0 0
Item08     2 0.17336955    2 0.4314618     0 0
Item09     5 0.12314521    6 0.5030880     0 0
Item10     2 0.10265274    1 0.5043314     0 0
Item11     4 0.19114249    5 0.4655814     0 0
Item12     5 0.19393177    5 0.4223461     0 0
Item13     2 0.22642950    2 0.4832577     0 0
Item14     2 0.13160157    1 0.4779796     0 0
Item15     2 0.18367392    2 0.5670734     0 0</code></pre>
</div>
</div>
</section>
<section id="可視化baseグラフィックス-1" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="可視化baseグラフィックス-1"><span class="header-section-number">5.2.4</span> 可視化（baseグラフィックス）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRA, <span class="at">type =</span> <span class="st">"IRP"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRA, <span class="at">type =</span> <span class="st">"RMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nr =</span> <span class="dv">2</span>, <span class="at">nc =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRA, <span class="at">type =</span> <span class="st">"TRP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRA, <span class="at">type =</span> <span class="st">"LRD"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="可視化ggexametrika-1" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="可視化ggexametrika-1"><span class="header-section-number">5.2.5</span> 可視化（ggExametrika）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotIRP_gg</span>(result.LRA)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotRMP_gg</span>(result.LRA)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotTRP_gg</span>(result.LRA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotLRD_gg</span>(result.LRA)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="推定法の選択gtm-vs-som" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="推定法の選択gtm-vs-som"><span class="header-section-number">5.3</span> 推定法の選択：GTM vs SOM</h2>
<section id="gtmgenerative-topographic-mapping" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="gtmgenerative-topographic-mapping"><span class="header-section-number">5.3.1</span> GTM（Generative Topographic Mapping）</h3>
<p>デフォルトの推定法です。項目とランクとの関係を表す行列<span class="math inline">\(\Pi_R\)</span>（サイズ <span class="math inline">\(J \times R\)</span>）に，緩やかな順序制約をつけたフィルタ行列<span class="math inline">\(S\)</span>（サイズ <span class="math inline">\(R \times R\)</span>）を乗算しながらEMアルゴリズムで推定します。データサイズが大きくなっても安定的に推定が進みます。</p>
</section>
<section id="somself-organizing-map" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="somself-organizing-map"><span class="header-section-number">5.3.2</span> SOM（Self-Organizing Map）</h3>
<p>自己組織化マップの方法も選択可能です。最初にランダムに生成した行列<span class="math inline">\(\Pi_R\)</span>に対し，データ行列に近い勝者ベクトルが周囲の重みをアップデートしていきます。乱数による近似なので，再現性のためにはシード値の設定が必要です。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>result.SOM <span class="ot">&lt;-</span> <span class="fu">LRA</span>(dat, <span class="at">nrank =</span> <span class="dv">6</span>, <span class="at">method =</span> <span class="st">"SOM"</span>, <span class="at">seed =</span> <span class="dv">12345</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Reached the maximum number of iterations.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Algorithm may not have converged. Interpret results with caution.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>result.SOM</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>estimating method is  SOM 
Item Reference Profile
         IRP1   IRP2  IRP3  IRP4  IRP5  IRP6
Item01 0.5960 0.6358 0.710 0.781 0.844 0.892
Item02 0.5435 0.6388 0.758 0.849 0.884 0.891
Item03 0.6035 0.6239 0.682 0.760 0.816 0.847
Item04 0.5025 0.6308 0.774 0.880 0.944 0.971
Item05 0.6823 0.7469 0.791 0.827 0.869 0.910
Item06 0.6893 0.7904 0.897 0.956 0.963 0.943
Item07 0.4398 0.5431 0.695 0.832 0.900 0.922
Item08 0.3663 0.4677 0.596 0.674 0.712 0.744
Item09 0.3333 0.3177 0.308 0.328 0.395 0.462
Item10 0.5351 0.5855 0.662 0.717 0.733 0.754
Item11 0.0716 0.0753 0.123 0.262 0.473 0.635
Item12 0.0694 0.1027 0.161 0.252 0.413 0.585
Item13 0.3763 0.5105 0.665 0.735 0.765 0.795
Item14 0.5207 0.6021 0.724 0.852 0.937 0.971
Item15 0.4808 0.5876 0.713 0.807 0.849 0.859

Item Reference Profile Indices
       Alpha      A Beta     B Gamma       C
Item01     2 0.0741    1 0.596   0.0  0.0000
Item02     2 0.1196    1 0.544   0.0  0.0000
Item03     3 0.0782    1 0.603   0.0  0.0000
Item04     2 0.1430    1 0.503   0.0  0.0000
Item05     1 0.0646    1 0.682   0.0  0.0000
Item06     2 0.1061    1 0.689   0.2 -0.0195
Item07     2 0.1515    2 0.543   0.0  0.0000
Item08     2 0.1280    2 0.468   0.0  0.0000
Item09     5 0.0671    6 0.462   0.4 -0.0254
Item10     2 0.0764    1 0.535   0.0  0.0000
Item11     4 0.2113    5 0.473   0.0  0.0000
Item12     5 0.1730    6 0.585   0.0  0.0000
Item13     2 0.1542    2 0.510   0.0  0.0000
Item14     3 0.1282    1 0.521   0.0  0.0000
Item15     2 0.1257    1 0.481   0.0  0.0000

Test Profile
                              Rank 1 Rank 2 Rank 3 Rank 4 Rank 5  Rank 6
Test Reference Profile         6.810  7.859  9.257 10.511 11.497  12.181
Latent Rank Ditribution      110.000 47.000 88.000 91.000 57.000 107.000
Rank Membership Distribution  88.291 77.753 78.235 83.372 84.584  87.765

Item Fit Indices
       model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
Item01       -265.054       -240.190      -283.343       49.729      86.307
Item02       -252.528       -235.436      -278.949       34.183      87.025
Item03       -282.154       -260.906      -293.598       42.495      65.383
Item04       -211.074       -192.072      -265.962       38.005     147.780
Item05       -235.901       -206.537      -247.403       58.727      81.732
Item06       -171.930       -153.940      -198.817       35.980      89.755
Item07       -251.168       -228.379      -298.345       45.579     139.933
Item08       -315.097       -293.225      -338.789       43.745      91.127
Item09       -323.478       -300.492      -327.842       45.972      54.700
Item10       -310.781       -288.198      -319.850       45.164      63.303
Item11       -239.989       -224.085      -299.265       31.806     150.360
Item12       -242.908       -214.797      -293.598       56.222     157.603
Item13       -295.624       -262.031      -328.396       67.186     132.730
Item14       -223.067       -204.953      -273.212       36.228     136.519
Item15       -273.041       -254.764      -302.847       36.555      96.166
       model_df null_df   NFI   RFI   IFI   TLI   CFI RMSEA    AIC    CAIC
Item01        8      13 0.424 0.064 0.467 0.075 0.431 0.102 33.729  -7.988
Item02        8      13 0.607 0.362 0.669 0.425 0.646 0.081 18.183 -23.534
Item03        8      13 0.350 0.000 0.399 0.000 0.341 0.093 26.495 -15.221
Item04        8      13 0.743 0.582 0.785 0.638 0.777 0.087 22.005 -19.712
Item05        8      13 0.281 0.000 0.312 0.000 0.262 0.113 42.727   1.011
Item06        8      13 0.599 0.349 0.658 0.408 0.635 0.084 19.980 -21.737
Item07        8      13 0.674 0.471 0.715 0.519 0.704 0.097 29.579 -12.138
Item08        8      13 0.520 0.220 0.570 0.257 0.542 0.095 27.745 -13.972
Item09        8      13 0.160 0.000 0.187 0.000 0.089 0.098 29.972 -11.745
Item10        8      13 0.287 0.000 0.328 0.000 0.261 0.096 29.164 -12.552
Item11        8      13 0.788 0.656 0.833 0.718 0.827 0.077 15.806 -25.911
Item12        8      13 0.643 0.420 0.678 0.458 0.667 0.110 40.222  -1.495
Item13        8      13 0.494 0.177 0.525 0.197 0.506 0.122 51.186   9.469
Item14        8      13 0.735 0.569 0.780 0.629 0.771 0.084 20.228 -21.489
Item15        8      13 0.620 0.382 0.676 0.442 0.657 0.085 20.555 -21.162
           BIC
Item01   0.012
Item02 -15.534
Item03  -7.221
Item04 -11.712
Item05   9.011
Item06 -13.737
Item07  -4.138
Item08  -5.972
Item09  -3.745
Item10  -4.552
Item11 -17.911
Item12   6.505
Item13  17.469
Item14 -13.489
Item15 -13.162

Model Fit Indices
Number of Latent rank: 6
Number of EM cycle: 100 
                   value
model_log_like -3893.793
bench_log_like -3560.005
null_log_like  -4350.217
model_Chi_sq     667.575
null_Chi_sq     1580.424
model_df         120.000
null_df          195.000
NFI                0.578
RFI                0.314
IFI                0.625
TLI                0.358
CFI                0.605
RMSEA              0.096
AIC              427.575
CAIC            -198.178
BIC              -78.178</code></pre>
</div>
</div>
</section>
<section id="結果の比較" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="結果の比較"><span class="header-section-number">5.3.3</span> 結果の比較</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>result.LRA<span class="sc">$</span>TestFitIndices</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq model_df
1      -3870.815      -3560.005     -4350.217     621.6196    1580.424 138.4909
  null_df       NFI       RFI       IFI       TLI       CFI      RMSEA      AIC
1     195 0.6066754 0.4461853 0.6649437 0.5089864 0.6512774 0.08361236 344.6378
       CAIC       BIC
1 -377.5381 -239.0471</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>result.SOM<span class="sc">$</span>TestFitIndices</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq model_df
1      -3893.793      -3560.005     -4350.217     667.5754    1580.424      120
  null_df       NFI       RFI       IFI       TLI       CFI      RMSEA      AIC
1     195 0.5775972 0.3135955 0.6250572 0.3577344 0.6047596 0.09562712 427.5754
       CAIC       BIC
1 -198.1775 -78.17753</code></pre>
</div>
</div>
</section>
</section>
<section id="多値データへの展開" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="多値データへの展開"><span class="header-section-number">5.4</span> 多値データへの展開</h2>
<section id="多肢選択ratedデータ" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="多肢選択ratedデータ"><span class="header-section-number">5.4.1</span> 多肢選択（rated）データ</h3>
<p>サンプルデータ<code>J35S5000</code>で多肢選択データの分析例を示します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>result.LRArated <span class="ot">&lt;-</span> <span class="fu">LRA</span>(J35S5000, <span class="at">nrank =</span> <span class="dv">10</span>, <span class="at">mic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>result.LRArated</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Monotonic increasing IRP option is TRUE.
Test Statistics
                   value
SampleSize 5000.00000000
TestLength   35.00000000
Median       17.00000000
Max          35.00000000
Min           2.00000000
Range        33.00000000
Mean         16.91100000
SD            4.97699036
Skewness      0.31342138
Kurtosis     -0.07429596
Alpha         0.70437957
Item Statistics
   ItemLabel  Obs ObsRatio ItemMean ItemSD ItemCORR ItemCORR_R
1         V1 4983    0.997    0.347  0.476    0.268     0.1762
2         V2 4993    0.999    0.284  0.451    0.133     0.0425
3         V3 4933    0.987    0.770  0.421    0.280     0.1992
4         V4 4997    0.999    0.338  0.473    0.341     0.2530
5         V5 4997    0.999    0.283  0.450    0.251     0.1636
6         V6 4995    0.999    0.867  0.340    0.221     0.1550
7         V7 4982    0.996    0.372  0.483    0.177     0.0808
8         V8 4999    1.000    0.372  0.483    0.359     0.2698
9         V9 4999    1.000    0.653  0.476    0.311     0.2211
10       V10 4991    0.998    0.396  0.489    0.377     0.2885
11       V11 4998    1.000    0.629  0.483    0.210     0.1147
12       V12 4996    0.999    0.571  0.495    0.372     0.2821
13       V13 4997    0.999    0.356  0.479    0.319     0.2291
14       V14 4977    0.995    0.330  0.470    0.312     0.2234
15       V15 4999    1.000    0.552  0.497    0.290     0.1952
16       V16 4996    0.999    0.354  0.478    0.286     0.1941
17       V17 4911    0.982    0.348  0.476    0.267     0.1747
18       V18 4999    1.000    0.753  0.431    0.352     0.2732
19       V19 4992    0.998    0.521  0.500    0.383     0.2927
20       V20 4996    0.999    0.271  0.444    0.230     0.1426
21       V21 4995    0.999    0.479  0.500    0.277     0.1806
22       V22 4984    0.997    0.524  0.499    0.302     0.2068
23       V23 4993    0.999    0.484  0.500    0.306     0.2105
24       V24 4998    1.000    0.508  0.500    0.381     0.2906
25       V25 4996    0.999    0.635  0.482    0.338     0.2478
26       V26 4991    0.998    0.382  0.486    0.391     0.3036
27       V27 4969    0.994    0.669  0.471    0.340     0.2520
28       V28 4997    0.999    0.466  0.499    0.402     0.3127
29       V29 4998    1.000    0.542  0.498    0.356     0.2643
30       V30 4994    0.999    0.784  0.412    0.330     0.2529
31       V31 4998    1.000    0.461  0.498    0.306     0.2115
32       V32 4974    0.995    0.247  0.432    0.227     0.1420
33       V33 4996    0.999    0.282  0.450    0.254     0.1666
34       V34 4996    0.999    0.492  0.500    0.229     0.1309
35       V35 4995    0.999    0.630  0.483    0.286     0.1937
Item Quantile Reference Matrix
       Q1    Q2    Q3    Q4    Q5    Q6    Q7    Q8    Q9   Q10
V1  0.178 0.261 0.210 0.314 0.322 0.354 0.399 0.409 0.486 0.669
V2  0.197 0.217 0.251 0.278 0.278 0.295 0.294 0.346 0.355 0.382
V3  0.517 0.673 0.722 0.765 0.745 0.809 0.853 0.845 0.896 0.957
V4  0.159 0.194 0.229 0.257 0.271 0.348 0.390 0.445 0.520 0.763
V5  0.159 0.202 0.199 0.223 0.257 0.281 0.285 0.328 0.380 0.637
V6  0.701 0.798 0.849 0.878 0.879 0.916 0.933 0.928 0.932 0.965
V7  0.259 0.305 0.275 0.326 0.365 0.402 0.423 0.423 0.454 0.570
V8  0.184 0.217 0.245 0.278 0.307 0.388 0.408 0.476 0.611 0.801
V9  0.370 0.534 0.596 0.631 0.664 0.697 0.712 0.802 0.801 0.898
V10 0.187 0.249 0.264 0.261 0.337 0.419 0.420 0.508 0.636 0.871
V11 0.474 0.541 0.596 0.602 0.618 0.652 0.644 0.699 0.732 0.849
V12 0.300 0.397 0.434 0.506 0.573 0.576 0.635 0.712 0.824 0.927
V13 0.163 0.233 0.272 0.283 0.312 0.334 0.383 0.456 0.558 0.726
V14 0.124 0.207 0.226 0.271 0.304 0.357 0.331 0.443 0.518 0.648
V15 0.314 0.428 0.504 0.542 0.539 0.531 0.571 0.672 0.742 0.828
V16 0.159 0.272 0.264 0.288 0.344 0.334 0.408 0.407 0.514 0.691
V17 0.144 0.218 0.310 0.271 0.344 0.368 0.411 0.449 0.461 0.599
V18 0.487 0.607 0.671 0.688 0.762 0.809 0.865 0.890 0.949 0.978
V19 0.252 0.339 0.399 0.441 0.470 0.598 0.620 0.659 0.748 0.938
V20 0.153 0.191 0.218 0.204 0.227 0.287 0.291 0.333 0.398 0.524
V21 0.246 0.345 0.380 0.475 0.485 0.517 0.543 0.584 0.664 0.704
V22 0.295 0.386 0.445 0.448 0.504 0.556 0.601 0.622 0.732 0.809
V23 0.262 0.339 0.356 0.393 0.478 0.520 0.601 0.614 0.674 0.758
V24 0.193 0.321 0.399 0.436 0.533 0.579 0.641 0.645 0.717 0.844
V25 0.312 0.502 0.544 0.576 0.667 0.750 0.742 0.777 0.814 0.855
V26 0.130 0.194 0.275 0.297 0.328 0.449 0.436 0.526 0.609 0.806
V27 0.386 0.500 0.569 0.612 0.696 0.733 0.733 0.814 0.856 0.911
V28 0.187 0.274 0.340 0.355 0.457 0.514 0.540 0.611 0.704 0.892
V29 0.290 0.373 0.445 0.463 0.521 0.570 0.635 0.658 0.784 0.890
V30 0.486 0.678 0.701 0.815 0.811 0.857 0.887 0.881 0.937 0.954
V31 0.236 0.336 0.380 0.396 0.473 0.441 0.494 0.550 0.626 0.831
V32 0.125 0.169 0.175 0.194 0.227 0.272 0.258 0.292 0.372 0.481
V33 0.137 0.189 0.181 0.211 0.278 0.303 0.359 0.341 0.387 0.559
V34 0.308 0.373 0.474 0.453 0.484 0.503 0.580 0.575 0.632 0.683
V35 0.404 0.498 0.601 0.568 0.630 0.683 0.675 0.726 0.791 0.890
Item Category Reference Profile
    ItemLabel CategoryLabel    rank1    rank2    rank3    rank4    rank5
1          V1       V1-Cat1 0.160702 0.151981 1.39e-01 1.29e-01 1.26e-01
2          V1       V1-Cat2 0.171401 0.165577 1.61e-01 1.47e-01 1.39e-01
3          V1       V1-Cat3 0.250322 0.258561 2.74e-01 3.01e-01 3.25e-01
4          V1       V1-Cat4 0.240354 0.234908 2.31e-01 2.31e-01 2.23e-01
5          V1       V1-Cat5 0.177221 0.188973 1.95e-01 1.92e-01 1.87e-01
6          V2       V2-Cat1 0.167136 0.198017 2.34e-01 2.52e-01 2.67e-01
7          V2       V2-Cat2 0.256135 0.207010 1.51e-01 1.11e-01 7.35e-02
8          V2       V2-Cat3 0.255201 0.256119 2.64e-01 2.72e-01 2.75e-01
9          V2       V2-Cat4 0.321529 0.338855 3.52e-01 3.66e-01 3.84e-01
10         V3       V3-Cat1 0.101926 0.064995 3.88e-02 3.16e-02 2.95e-02
11         V3       V3-Cat2 0.207859 0.166968 1.23e-01 1.01e-01 9.19e-02
12         V3       V3-Cat3 0.568325 0.643477 7.11e-01 7.49e-01 7.75e-01
13         V3       V3-Cat4 0.121890 0.124560 1.27e-01 1.18e-01 1.03e-01
14         V4       V4-Cat1 0.085362 0.082838 8.75e-02 8.88e-02 9.01e-02
15         V4       V4-Cat2 0.295254 0.296079 2.86e-01 2.85e-01 2.55e-01
16         V4       V4-Cat3 0.209903 0.215406 2.23e-01 2.25e-01 2.61e-01
17         V4       V4-Cat4 0.246144 0.242142 2.25e-01 2.77e-01 2.95e-01
18         V4       V4-Cat5 0.115594 0.113855 1.26e-01 8.93e-02 7.11e-02
19         V4       V4-Cat6 0.047743 0.049681 5.23e-02 3.47e-02 2.74e-02
20         V5       V5-Cat1 0.155779 0.127442 9.09e-02 6.43e-02 5.37e-02
21         V5       V5-Cat2 0.218851 0.220231 2.27e-01 2.40e-01 2.46e-01
22         V5       V5-Cat3 0.380675 0.425797 4.71e-01 4.96e-01 5.16e-01
23         V5       V5-Cat4 0.244695 0.226530 2.11e-01 2.00e-01 1.84e-01
24         V6       V6-Cat1 0.010337 0.004712 1.47e-03 1.10e-03 1.15e-03
25         V6       V6-Cat2 0.084484 0.076870 5.93e-02 4.32e-02 3.78e-02
26         V6       V6-Cat3 0.141265 0.120281 1.01e-01 8.91e-02 7.21e-02
27         V6       V6-Cat4 0.020483 0.011283 5.28e-03 4.94e-03 4.65e-03
28         V6       V6-Cat5 0.738872 0.783464 8.30e-01 8.58e-01 8.81e-01
29         V6       V6-Cat6 0.004558 0.003389 3.11e-03 3.24e-03 3.33e-03
30         V7       V7-Cat1 0.071050 0.067340 7.44e-02 1.13e-01 3.36e-02
31         V7       V7-Cat2 0.376140 0.378440 3.78e-01 3.49e-01 3.95e-01
32         V7       V7-Cat3 0.334140 0.336463 3.38e-01 3.42e-01 3.47e-01
33         V7       V7-Cat4 0.218670 0.217756 2.10e-01 1.96e-01 2.24e-01
34         V8       V8-Cat1 0.194270 0.193325 1.92e-01 1.97e-01 1.88e-01
35         V8       V8-Cat2 0.187308 0.204674 2.32e-01 2.53e-01 2.71e-01
36         V8       V8-Cat3 0.119084 0.114607 1.09e-01 9.90e-02 8.20e-02
37         V8       V8-Cat4 0.207077 0.224882 2.51e-01 2.74e-01 3.03e-01
38         V8       V8-Cat5 0.128616 0.097776 6.24e-02 4.13e-02 3.06e-02
39         V8       V8-Cat6 0.163645 0.164736 1.54e-01 1.36e-01 1.25e-01
40         V9       V9-Cat1 0.066599 0.044366 2.47e-02 1.63e-02 1.34e-02
41         V9       V9-Cat2 0.118450 0.098472 7.94e-02 6.94e-02 6.52e-02
42         V9       V9-Cat3 0.110387 0.090098 6.25e-02 4.07e-02 2.89e-02
43         V9       V9-Cat4 0.436433 0.507443 5.82e-01 6.19e-01 6.42e-01
44         V9       V9-Cat5 0.114586 0.096521 8.04e-02 7.48e-02 6.82e-02
45         V9       V9-Cat6 0.153546 0.163100 1.71e-01 1.80e-01 1.82e-01
46        V10      V10-Cat1 0.278156 0.292461 3.26e-01 3.62e-01 3.71e-01
47        V10      V10-Cat2 0.129973 0.115018 9.73e-02 8.71e-02 7.53e-02
48        V10      V10-Cat3 0.346028 0.336355 3.19e-01 2.87e-01 2.52e-01
49        V10      V10-Cat4 0.244458 0.255767 2.57e-01 2.64e-01 3.02e-01
50        V10      V10-Cat5 0.001386 0.000399 5.54e-06 1.20e-10 5.65e-12
51        V11      V11-Cat1 0.098465 0.091053 8.65e-02 7.81e-02 8.52e-02
52        V11      V11-Cat2 0.274928 0.271579 2.59e-01 2.69e-01 2.60e-01
53        V11      V11-Cat3 0.514996 0.559695 6.06e-01 6.19e-01 6.20e-01
54        V11      V11-Cat4 0.110236 0.077271 4.85e-02 3.37e-02 3.55e-02
55        V11      V11-Cat5 0.001375 0.000402 7.41e-06 3.14e-10 3.33e-09
56        V12      V12-Cat1 0.253810 0.253306 2.40e-01 2.26e-01 2.28e-01
57        V12      V12-Cat2 0.054170 0.040727 2.70e-02 2.14e-02 2.00e-02
58        V12      V12-Cat3 0.166075 0.126333 8.69e-02 7.01e-02 6.50e-02
59        V12      V12-Cat4 0.103467 0.087702 7.61e-02 6.83e-02 5.98e-02
60        V12      V12-Cat5 0.080713 0.095045 1.03e-01 1.02e-01 9.36e-02
61        V12      V12-Cat6 0.341765 0.396888 4.66e-01 5.12e-01 5.33e-01
62        V13      V13-Cat1 0.262536 0.306057 3.65e-01 4.09e-01 4.25e-01
63        V13      V13-Cat2 0.219088 0.239018 2.61e-01 2.76e-01 2.91e-01
64        V13      V13-Cat3 0.124337 0.092505 6.13e-02 4.93e-02 4.90e-02
65        V13      V13-Cat4 0.209241 0.211712 1.97e-01 1.74e-01 1.66e-01
66        V13      V13-Cat5 0.181466 0.148642 1.15e-01 9.04e-02 6.84e-02
67        V13      V13-Cat6 0.003331 0.002065 1.14e-03 6.73e-04 2.36e-04
68        V14      V14-Cat1 0.127174 0.110982 8.94e-02 7.58e-02 7.35e-02
69        V14      V14-Cat2 0.053256 0.043999 4.01e-02 3.95e-02 4.27e-02
70        V14      V14-Cat3 0.401542 0.404420 4.03e-01 4.14e-01 4.18e-01
71        V14      V14-Cat4 0.169232 0.199198 2.40e-01 2.73e-01 3.00e-01
72        V14      V14-Cat5 0.124973 0.113546 9.80e-02 8.09e-02 6.75e-02
73        V14      V14-Cat6 0.123825 0.127855 1.30e-01 1.17e-01 9.89e-02
74        V15      V15-Cat1 0.113251 0.111643 9.55e-02 6.93e-02 5.58e-02
75        V15      V15-Cat2 0.221394 0.205947 1.82e-01 1.57e-01 1.46e-01
76        V15      V15-Cat3 0.308392 0.253994 2.17e-01 2.26e-01 2.51e-01
77        V15      V15-Cat4 0.355762 0.426277 5.04e-01 5.47e-01 5.47e-01
78        V15      V15-Cat5 0.001041 0.001623 9.94e-04 2.26e-04 3.06e-07
79        V15      V15-Cat6 0.000161 0.000516 6.35e-04 3.69e-04 7.82e-05
80        V16      V16-Cat1 0.147395 0.135862 1.40e-01 1.50e-01 1.50e-01
81        V16      V16-Cat2 0.171606 0.171205 1.64e-01 1.59e-01 1.64e-01
82        V16      V16-Cat3 0.135333 0.107247 6.84e-02 4.49e-02 3.52e-02
83        V16      V16-Cat4 0.242538 0.260492 2.79e-01 2.80e-01 2.77e-01
84        V16      V16-Cat5 0.224554 0.248058 2.79e-01 3.06e-01 3.25e-01
85        V16      V16-Cat6 0.078574 0.077136 6.97e-02 5.96e-02 4.83e-02
86        V17      V17-Cat1 0.181961 0.224921 2.75e-01 3.14e-01 3.54e-01
87        V17      V17-Cat2 0.172907 0.172655 1.75e-01 1.72e-01 1.69e-01
88        V17      V17-Cat3 0.243380 0.254842 2.65e-01 2.71e-01 2.65e-01
89        V17      V17-Cat4 0.122512 0.098008 7.50e-02 5.99e-02 5.10e-02
90        V17      V17-Cat5 0.197089 0.173737 1.45e-01 1.27e-01 1.08e-01
91        V17      V17-Cat6 0.082150 0.075837 6.53e-02 5.59e-02 5.22e-02
92        V18      V18-Cat1 0.113421 0.105425 9.13e-02 7.57e-02 6.58e-02
93        V18      V18-Cat2 0.541136 0.585410 6.39e-01 6.81e-01 7.29e-01
94        V18      V18-Cat3 0.212346 0.180239 1.54e-01 1.45e-01 1.25e-01
95        V18      V18-Cat4 0.133097 0.128926 1.16e-01 9.78e-02 8.04e-02
96        V19      V19-Cat1 0.161588 0.140610 1.17e-01 1.09e-01 1.03e-01
97        V19      V19-Cat2 0.301880 0.313536 3.16e-01 3.00e-01 2.84e-01
98        V19      V19-Cat3 0.304595 0.339441 3.85e-01 4.26e-01 4.72e-01
99        V19      V19-Cat4 0.231937 0.206414 1.82e-01 1.65e-01 1.41e-01
100       V20      V20-Cat1 0.188485 0.201553 2.12e-01 2.19e-01 2.35e-01
101       V20      V20-Cat2 0.231254 0.213300 1.98e-01 1.90e-01 1.83e-01
102       V20      V20-Cat3 0.402854 0.431543 4.60e-01 4.73e-01 4.72e-01
103       V20      V20-Cat4 0.177407 0.153604 1.30e-01 1.17e-01 1.11e-01
104       V21      V21-Cat1 0.291439 0.339249 3.99e-01 4.47e-01 4.80e-01
105       V21      V21-Cat2 0.195266 0.206700 2.13e-01 2.00e-01 1.82e-01
106       V21      V21-Cat3 0.134619 0.115961 9.77e-02 8.44e-02 7.28e-02
107       V21      V21-Cat4 0.163155 0.164282 1.61e-01 1.54e-01 1.51e-01
108       V21      V21-Cat5 0.087605 0.067845 4.13e-02 2.84e-02 2.43e-02
109       V21      V21-Cat6 0.127915 0.105964 8.88e-02 8.70e-02 8.97e-02
110       V22      V22-Cat1 0.353845 0.393110 4.30e-01 4.58e-01 4.95e-01
111       V22      V22-Cat2 0.258570 0.248252 2.38e-01 2.31e-01 2.19e-01
112       V22      V22-Cat3 0.304569 0.288038 2.68e-01 2.52e-01 2.34e-01
113       V22      V22-Cat4 0.083016 0.070601 6.41e-02 5.92e-02 5.17e-02
114       V23      V23-Cat1 0.075094 0.071572 7.79e-02 8.38e-02 7.72e-02
115       V23      V23-Cat2 0.098889 0.080867 6.51e-02 5.40e-02 4.60e-02
116       V23      V23-Cat3 0.327978 0.341034 3.61e-01 4.03e-01 4.58e-01
117       V23      V23-Cat4 0.205509 0.219643 2.11e-01 1.87e-01 1.67e-01
118       V23      V23-Cat5 0.168429 0.162206 1.66e-01 1.77e-01 1.79e-01
119       V23      V23-Cat6 0.124102 0.124678 1.18e-01 9.60e-02 7.27e-02
120       V24      V24-Cat1 0.151197 0.130124 1.13e-01 1.01e-01 7.72e-02
121       V24      V24-Cat2 0.385733 0.345418 2.89e-01 2.36e-01 1.95e-01
122       V24      V24-Cat3 0.249757 0.229586 2.13e-01 2.12e-01 2.13e-01
123       V24      V24-Cat4 0.213313 0.294873 3.85e-01 4.50e-01 5.15e-01
124       V25      V25-Cat1 0.213057 0.201623 1.83e-01 1.64e-01 1.49e-01
125       V25      V25-Cat2 0.147003 0.110309 7.89e-02 6.51e-02 5.84e-02
126       V25      V25-Cat3 0.376683 0.446406 5.23e-01 5.89e-01 6.54e-01
127       V25      V25-Cat4 0.263257 0.241662 2.15e-01 1.83e-01 1.39e-01
128       V26      V26-Cat1 0.407068 0.408253 4.00e-01 3.71e-01 3.15e-01
129       V26      V26-Cat2 0.205853 0.195390 1.93e-01 2.02e-01 2.05e-01
130       V26      V26-Cat3 0.203517 0.191830 1.69e-01 1.53e-01 1.53e-01
131       V26      V26-Cat4 0.181319 0.203483 2.37e-01 2.74e-01 3.26e-01
132       V26      V26-Cat5 0.002242 0.001045 3.10e-04 7.23e-05 5.92e-06
133       V27      V27-Cat1 0.098952 0.064574 3.70e-02 2.70e-02 2.24e-02
134       V27      V27-Cat2 0.147000 0.129052 1.06e-01 9.16e-02 8.83e-02
135       V27      V27-Cat3 0.413926 0.477579 5.60e-01 6.36e-01 6.95e-01
136       V27      V27-Cat4 0.257137 0.262822 2.48e-01 2.06e-01 1.62e-01
137       V27      V27-Cat5 0.082986 0.065973 4.95e-02 3.98e-02 3.23e-02
138       V28      V28-Cat1 0.162789 0.152142 1.45e-01 1.48e-01 1.53e-01
139       V28      V28-Cat2 0.216774 0.258750 3.12e-01 3.71e-01 4.39e-01
140       V28      V28-Cat3 0.198249 0.161397 1.33e-01 1.27e-01 1.21e-01
141       V28      V28-Cat4 0.147478 0.147008 1.37e-01 1.07e-01 7.74e-02
142       V28      V28-Cat5 0.177291 0.193067 2.00e-01 1.85e-01 1.61e-01
143       V28      V28-Cat6 0.097419 0.087636 7.39e-02 6.16e-02 4.79e-02
144       V29      V29-Cat1 0.161205 0.148828 1.23e-01 9.84e-02 7.97e-02
145       V29      V29-Cat2 0.351848 0.389699 4.28e-01 4.54e-01 4.86e-01
146       V29      V29-Cat3 0.394410 0.404743 4.21e-01 4.29e-01 4.18e-01
147       V29      V29-Cat4 0.088743 0.053975 2.62e-02 1.71e-02 1.69e-02
148       V29      V29-Cat5 0.003003 0.001272 3.80e-04 4.21e-04 3.29e-04
149       V29      V29-Cat6 0.000791 0.001482 1.16e-03 4.06e-04 6.45e-05
150       V30      V30-Cat1 0.125107 0.110867 9.44e-02 7.94e-02 6.57e-02
151       V30      V30-Cat2 0.226068 0.182668 1.30e-01 8.99e-02 6.53e-02
152       V30      V30-Cat3 0.136420 0.100250 6.57e-02 4.96e-02 4.22e-02
153       V30      V30-Cat4 0.511024 0.605816 7.10e-01 7.81e-01 8.27e-01
154       V30      V30-Cat5 0.001382 0.000399 5.54e-06 1.20e-10 5.65e-12
155       V31      V31-Cat1 0.189911 0.213328 2.40e-01 2.51e-01 2.47e-01
156       V31      V31-Cat2 0.128855 0.109379 8.88e-02 7.71e-02 7.19e-02
157       V31      V31-Cat3 0.300060 0.343712 3.91e-01 4.19e-01 4.37e-01
158       V31      V31-Cat4 0.138347 0.098160 6.59e-02 6.20e-02 7.00e-02
159       V31      V31-Cat5 0.102230 0.101983 9.81e-02 9.24e-02 8.79e-02
160       V31      V31-Cat6 0.140596 0.133438 1.16e-01 9.84e-02 8.60e-02
161       V32      V32-Cat1 0.236462 0.249584 2.59e-01 2.65e-01 2.68e-01
162       V32      V32-Cat2 0.221174 0.206664 1.84e-01 1.65e-01 1.51e-01
163       V32      V32-Cat3 0.359929 0.359792 3.64e-01 3.63e-01 3.53e-01
164       V32      V32-Cat4 0.182435 0.183960 1.92e-01 2.07e-01 2.28e-01
165       V33      V33-Cat1 0.165271 0.144629 1.20e-01 9.71e-02 8.23e-02
166       V33      V33-Cat2 0.181101 0.177636 1.75e-01 1.74e-01 1.67e-01
167       V33      V33-Cat3 0.239750 0.233243 2.28e-01 2.27e-01 2.29e-01
168       V33      V33-Cat4 0.144066 0.144048 1.41e-01 1.33e-01 1.29e-01
169       V33      V33-Cat5 0.171627 0.191742 2.11e-01 2.34e-01 2.63e-01
170       V33      V33-Cat6 0.098184 0.108703 1.26e-01 1.34e-01 1.29e-01
171       V34      V34-Cat1 0.142739 0.128452 1.19e-01 1.17e-01 1.12e-01
172       V34      V34-Cat2 0.371022 0.411988 4.49e-01 4.59e-01 4.76e-01
173       V34      V34-Cat3 0.299943 0.261322 2.08e-01 1.73e-01 1.57e-01
174       V34      V34-Cat4 0.186296 0.198238 2.24e-01 2.51e-01 2.55e-01
175       V35      V35-Cat1 0.452647 0.522290 5.87e-01 6.04e-01 6.14e-01
176       V35      V35-Cat2 0.093240 0.069967 5.28e-02 4.59e-02 4.02e-02
177       V35      V35-Cat3 0.175810 0.161466 1.46e-01 1.43e-01 1.45e-01
178       V35      V35-Cat4 0.278303 0.246277 2.14e-01 2.07e-01 2.01e-01
       rank6    rank7    rank8    rank9   rank10
1   1.24e-01 1.25e-01 1.26e-01 1.09e-01 8.29e-02
2   1.39e-01 1.38e-01 1.36e-01 1.21e-01 9.46e-02
3   3.40e-01 3.55e-01 3.83e-01 4.61e-01 5.63e-01
4   2.11e-01 2.00e-01 1.89e-01 1.64e-01 1.34e-01
5   1.87e-01 1.82e-01 1.66e-01 1.44e-01 1.26e-01
6   2.95e-01 3.25e-01 3.43e-01 3.64e-01 3.88e-01
7   4.18e-02 2.27e-02 1.07e-02 3.54e-03 1.33e-03
8   2.80e-01 2.93e-01 3.06e-01 3.17e-01 3.29e-01
9   3.83e-01 3.60e-01 3.40e-01 3.15e-01 2.82e-01
10  2.85e-02 2.86e-02 2.86e-02 2.07e-02 8.74e-03
11  7.89e-02 6.67e-02 6.11e-02 5.18e-02 4.04e-02
12  8.07e-01 8.39e-01 8.59e-01 8.83e-01 9.12e-01
13  8.54e-02 6.56e-02 5.12e-02 4.45e-02 3.91e-02
14  9.06e-02 8.92e-02 8.13e-02 6.91e-02 6.11e-02
15  2.15e-01 1.81e-01 1.54e-01 1.15e-01 7.55e-02
16  3.13e-01 3.68e-01 4.34e-01 5.43e-01 6.52e-01
17  2.91e-01 2.71e-01 2.46e-01 2.12e-01 1.76e-01
18  6.46e-02 6.19e-02 5.76e-02 4.13e-02 2.30e-02
19  2.66e-02 2.82e-02 2.69e-02 1.91e-02 1.20e-02
20  5.05e-02 4.61e-02 4.03e-02 3.80e-02 3.78e-02
21  2.50e-01 2.61e-01 2.87e-01 3.84e-01 5.24e-01
22  5.25e-01 5.16e-01 4.94e-01 4.32e-01 3.40e-01
23  1.75e-01 1.77e-01 1.78e-01 1.45e-01 9.80e-02
24  9.22e-04 1.24e-03 1.99e-03 1.88e-03 2.03e-03
25  3.58e-02 2.95e-02 2.63e-02 2.40e-02 2.18e-02
26  5.37e-02 4.48e-02 4.40e-02 4.34e-02 3.63e-02
27  3.46e-03 3.41e-03 3.95e-03 3.60e-03 2.50e-03
28  9.04e-01 9.19e-01 9.22e-01 9.26e-01 9.37e-01
29  2.53e-03 1.61e-03 1.52e-03 1.49e-03 6.29e-04
30  1.68e-02 1.32e-02 1.66e-02 2.06e-02 1.46e-02
31  3.79e-01 3.58e-01 3.40e-01 3.02e-01 2.60e-01
32  3.68e-01 3.87e-01 3.91e-01 4.16e-01 4.77e-01
33  2.36e-01 2.42e-01 2.52e-01 2.61e-01 2.48e-01
34  1.72e-01 1.60e-01 1.35e-01 8.87e-02 5.37e-02
35  2.82e-01 2.71e-01 2.42e-01 2.02e-01 1.67e-01
36  6.15e-02 4.95e-02 4.11e-02 2.86e-02 2.03e-02
37  3.43e-01 3.95e-01 4.78e-01 6.09e-01 7.17e-01
38  2.32e-02 1.86e-02 1.40e-02 7.42e-03 3.10e-03
39  1.18e-01 1.06e-01 9.01e-02 6.44e-02 3.94e-02
40  1.15e-02 9.30e-03 5.38e-03 1.88e-03 4.18e-04
41  6.31e-02 5.63e-02 4.84e-02 3.98e-02 3.04e-02
42  2.28e-02 1.74e-02 1.13e-02 7.18e-03 6.43e-03
43  6.76e-01 7.23e-01 7.69e-01 8.05e-01 8.36e-01
44  5.26e-02 3.61e-02 2.33e-02 1.18e-02 4.54e-03
45  1.74e-01 1.58e-01 1.43e-01 1.35e-01 1.22e-01
46  3.55e-01 3.30e-01 2.96e-01 2.35e-01 1.63e-01
47  6.20e-02 5.10e-02 4.16e-02 2.98e-02 2.06e-02
48  2.21e-01 1.94e-01 1.51e-01 8.76e-02 3.88e-02
49  3.62e-01 4.25e-01 5.11e-01 6.47e-01 7.78e-01
50  1.46e-12 2.71e-13 4.89e-14 4.54e-15 3.49e-17
51  6.36e-02 4.64e-02 2.84e-02 1.63e-02 1.11e-02
52  2.84e-01 3.03e-01 3.05e-01 2.61e-01 2.01e-01
53  6.20e-01 6.28e-01 6.53e-01 7.15e-01 7.86e-01
54  3.26e-02 2.28e-02 1.36e-02 6.85e-03 2.22e-03
55  8.10e-11 1.29e-11 1.78e-12 1.11e-13 2.59e-16
56  2.41e-01 2.33e-01 1.92e-01 1.28e-01 7.40e-02
57  1.81e-02 1.54e-02 1.21e-02 7.31e-03 4.43e-03
58  5.79e-02 4.14e-02 2.30e-02 1.03e-02 4.99e-03
59  5.02e-02 4.09e-02 3.35e-02 2.54e-02 1.66e-02
60  7.89e-02 6.17e-02 4.25e-02 2.43e-02 1.25e-02
61  5.54e-01 6.08e-01 6.97e-01 8.05e-01 8.87e-01
62  4.08e-01 3.73e-01 3.30e-01 2.80e-01 2.34e-01
63  3.16e-01 3.63e-01 4.44e-01 5.60e-01 6.58e-01
64  5.80e-02 7.04e-02 7.37e-02 5.71e-02 3.45e-02
65  1.67e-01 1.56e-01 1.28e-01 9.15e-02 6.77e-02
66  5.08e-02 3.75e-02 2.38e-02 1.18e-02 5.56e-03
67  3.48e-05 1.15e-06 1.04e-08 1.72e-09 8.18e-11
68  7.53e-02 7.51e-02 6.97e-02 5.85e-02 4.80e-02
69  5.00e-02 5.39e-02 5.00e-02 5.04e-02 5.45e-02
70  4.01e-01 3.71e-01 3.25e-01 2.75e-01 2.45e-01
71  3.23e-01 3.58e-01 4.24e-01 5.08e-01 5.67e-01
72  6.08e-02 5.45e-02 4.43e-02 3.36e-02 2.76e-02
73  8.96e-02 8.83e-02 8.74e-02 7.43e-02 5.83e-02
74  5.86e-02 4.68e-02 3.48e-02 2.69e-02 2.48e-02
75  1.50e-01 1.38e-01 1.21e-01 9.15e-02 6.05e-02
76  2.39e-01 2.54e-01 2.29e-01 1.81e-01 1.46e-01
77  5.51e-01 5.61e-01 6.15e-01 7.01e-01 7.69e-01
78  1.59e-05 1.32e-07 4.12e-08 8.17e-09 4.41e-10
79  1.84e-04 1.66e-05 1.00e-06 7.82e-09 7.03e-10
80  1.42e-01 1.35e-01 1.28e-01 1.06e-01 7.90e-02
81  1.76e-01 1.87e-01 2.00e-01 2.07e-01 1.95e-01
82  3.04e-02 2.96e-02 2.72e-02 1.90e-02 1.02e-02
83  2.70e-01 2.45e-01 1.98e-01 1.39e-01 1.02e-01
84  3.44e-01 3.72e-01 4.11e-01 4.92e-01 5.88e-01
85  3.77e-02 3.19e-02 3.50e-02 3.76e-02 2.63e-02
86  3.88e-01 4.11e-01 4.20e-01 4.46e-01 5.03e-01
87  1.76e-01 1.76e-01 1.58e-01 1.43e-01 1.43e-01
88  2.45e-01 2.31e-01 2.45e-01 2.61e-01 2.46e-01
89  5.02e-02 5.47e-02 5.96e-02 5.13e-02 2.95e-02
90  8.79e-02 7.72e-02 7.59e-02 6.83e-02 5.51e-02
91  5.19e-02 5.00e-02 4.20e-02 3.07e-02 2.38e-02
92  5.40e-02 3.99e-02 2.69e-02 1.69e-02 1.10e-02
93  7.86e-01 8.43e-01 8.95e-01 9.41e-01 9.66e-01
94  9.56e-02 6.80e-02 4.71e-02 2.84e-02 1.78e-02
95  6.49e-02 4.90e-02 3.05e-02 1.40e-02 5.61e-03
96  9.12e-02 7.73e-02 6.08e-02 4.27e-02 2.85e-02
97  2.70e-01 2.56e-01 2.26e-01 1.52e-01 7.83e-02
98  5.26e-01 5.78e-01 6.44e-01 7.60e-01 8.65e-01
99  1.13e-01 8.93e-02 6.90e-02 4.48e-02 2.81e-02
100 2.57e-01 2.82e-01 3.27e-01 3.91e-01 4.34e-01
101 1.84e-01 1.93e-01 1.93e-01 1.95e-01 2.05e-01
102 4.51e-01 4.17e-01 3.62e-01 2.81e-01 2.18e-01
103 1.07e-01 1.08e-01 1.18e-01 1.32e-01 1.43e-01
104 5.12e-01 5.46e-01 5.79e-01 6.14e-01 6.43e-01
105 1.69e-01 1.69e-01 1.78e-01 1.68e-01 1.38e-01
106 6.54e-02 5.63e-02 4.39e-02 3.16e-02 2.40e-02
107 1.46e-01 1.37e-01 1.31e-01 1.40e-01 1.54e-01
108 1.82e-02 1.25e-02 9.24e-03 6.62e-03 5.79e-03
109 8.86e-02 7.92e-02 5.90e-02 3.98e-02 3.45e-02
110 5.39e-01 5.79e-01 6.23e-01 6.85e-01 7.41e-01
111 2.02e-01 1.85e-01 1.71e-01 1.46e-01 1.15e-01
112 2.11e-01 1.92e-01 1.69e-01 1.43e-01 1.26e-01
113 4.78e-02 4.41e-02 3.67e-02 2.63e-02 1.80e-02
114 7.02e-02 6.55e-02 6.12e-02 5.81e-02 5.39e-02
115 4.28e-02 3.94e-02 3.33e-02 2.45e-02 1.55e-02
116 5.13e-01 5.57e-01 5.95e-01 6.46e-01 6.95e-01
117 1.49e-01 1.39e-01 1.40e-01 1.40e-01 1.36e-01
118 1.69e-01 1.57e-01 1.40e-01 1.12e-01 8.67e-02
119 5.53e-02 4.21e-02 3.06e-02 1.91e-02 1.23e-02
120 5.66e-02 5.05e-02 4.76e-02 3.43e-02 1.78e-02
121 1.69e-01 1.53e-01 1.44e-01 1.29e-01 1.05e-01
122 1.98e-01 1.74e-01 1.61e-01 1.41e-01 1.11e-01
123 5.76e-01 6.22e-01 6.47e-01 6.95e-01 7.66e-01
124 1.39e-01 1.31e-01 1.18e-01 9.62e-02 7.66e-02
125 5.46e-02 5.27e-02 5.30e-02 5.82e-02 6.74e-02
126 7.05e-01 7.39e-01 7.70e-01 8.00e-01 8.18e-01
127 1.01e-01 7.75e-02 5.93e-02 4.52e-02 3.82e-02
128 2.51e-01 2.08e-01 1.69e-01 1.20e-01 8.16e-02
129 1.99e-01 1.91e-01 1.85e-01 1.55e-01 1.07e-01
130 1.60e-01 1.52e-01 1.32e-01 1.12e-01 9.74e-02
131 3.90e-01 4.49e-01 5.14e-01 6.13e-01 7.14e-01
132 5.09e-08 4.06e-09 2.04e-09 4.98e-10 2.05e-11
133 2.10e-02 2.06e-02 1.77e-02 1.14e-02 6.53e-03
134 9.07e-02 8.82e-02 7.60e-02 6.12e-02 5.27e-02
135 7.35e-01 7.63e-01 7.88e-01 8.23e-01 8.61e-01
136 1.29e-01 1.12e-01 1.06e-01 9.35e-02 6.99e-02
137 2.44e-02 1.69e-02 1.21e-02 1.06e-02 9.75e-03
138 1.51e-01 1.43e-01 1.21e-01 8.90e-02 6.25e-02
139 4.96e-01 5.36e-01 5.94e-01 7.09e-01 8.17e-01
140 1.12e-01 9.75e-02 7.74e-02 5.05e-02 2.92e-02
141 6.00e-02 5.22e-02 4.06e-02 1.95e-02 5.42e-03
142 1.45e-01 1.42e-01 1.43e-01 1.20e-01 8.12e-02
143 3.65e-02 2.99e-02 2.35e-02 1.27e-02 4.29e-03
144 6.98e-02 7.30e-02 7.21e-02 4.74e-02 2.47e-02
145 5.34e-01 5.89e-01 6.55e-01 7.62e-01 8.56e-01
146 3.79e-01 3.22e-01 2.60e-01 1.83e-01 1.15e-01
147 1.78e-02 1.64e-02 1.30e-02 7.60e-03 4.09e-03
148 1.00e-04 9.23e-06 2.13e-07 4.66e-08 5.11e-09
149 8.06e-06 3.40e-06 8.69e-07 1.47e-07 1.51e-08
150 5.51e-02 4.96e-02 4.85e-02 4.38e-02 4.09e-02
151 5.33e-02 4.94e-02 4.91e-02 3.72e-02 2.17e-02
152 3.43e-02 2.50e-02 1.61e-02 8.22e-03 4.09e-03
153 8.57e-01 8.76e-01 8.86e-01 9.11e-01 9.33e-01
154 1.46e-12 2.71e-13 4.89e-14 4.53e-15 3.49e-17
155 2.38e-01 2.19e-01 1.83e-01 1.32e-01 9.49e-02
156 6.89e-02 6.53e-02 5.57e-02 3.57e-02 1.88e-02
157 4.48e-01 4.64e-01 5.15e-01 6.23e-01 7.28e-01
158 7.77e-02 8.12e-02 8.21e-02 7.83e-02 6.92e-02
159 8.78e-02 9.21e-02 8.86e-02 6.94e-02 4.83e-02
160 7.94e-02 7.79e-02 7.55e-02 6.17e-02 4.08e-02
161 2.60e-01 2.41e-01 2.26e-01 2.04e-01 1.70e-01
162 1.43e-01 1.35e-01 1.30e-01 1.29e-01 1.21e-01
163 3.54e-01 3.72e-01 3.70e-01 3.33e-01 3.02e-01
164 2.43e-01 2.53e-01 2.74e-01 3.34e-01 4.07e-01
165 7.99e-02 8.09e-02 7.54e-02 5.67e-02 3.97e-02
166 1.55e-01 1.48e-01 1.49e-01 1.42e-01 1.17e-01
167 2.27e-01 2.23e-01 2.18e-01 2.02e-01 1.89e-01
168 1.23e-01 1.15e-01 1.09e-01 9.78e-02 8.18e-02
169 2.92e-01 3.15e-01 3.30e-01 3.86e-01 4.64e-01
170 1.23e-01 1.18e-01 1.19e-01 1.15e-01 1.09e-01
171 1.06e-01 1.10e-01 1.30e-01 1.28e-01 9.54e-02
172 5.09e-01 5.37e-01 5.50e-01 5.75e-01 6.15e-01
173 1.45e-01 1.29e-01 1.14e-01 9.63e-02 7.54e-02
174 2.40e-01 2.24e-01 2.06e-01 2.00e-01 2.14e-01
175 6.29e-01 6.50e-01 6.95e-01 7.68e-01 8.35e-01
176 3.43e-02 2.88e-02 2.33e-02 1.61e-02 1.06e-02
177 1.51e-01 1.51e-01 1.30e-01 1.03e-01 8.64e-02
178 1.86e-01 1.70e-01 1.51e-01 1.12e-01 6.83e-02

Test Profile
                              Rank 1  Rank 2  Rank 3  Rank 4  Rank 5  Rank 6
Test Reference Profile        11.221  12.526  13.999  15.103  16.155  17.284
Latent Rank Ditribution      605.000 453.000 513.000 462.000 504.000 449.000
Rank Membership Distribution 537.070 500.858 510.664 511.630 517.705 511.854
                              Rank 7  Rank 8  Rank 9 Rank 10
Test Reference Profile        18.443  19.889  22.255  24.641
Latent Rank Ditribution      494.000 533.000 460.000 527.000
Rank Membership Distribution 502.493 483.411 442.111 482.205

Item Fit Indices
    model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
V1       -7567.150      -7543.816     -7669.959       46.668     252.286
V2       -6199.571      -6147.573     -6493.515      103.997     691.883
V3       -3648.104      -3626.982     -3832.371       42.242     410.777
V4       -7511.898      -7502.414     -7814.675       18.967     624.521
V5       -5899.644      -5868.361     -6080.987       62.565     425.253
V6       -2519.741      -2506.394     -2619.774       26.693     226.759
V7       -5955.665      -6002.712     -6049.723        0.000      94.022
V8       -7502.169      -7493.878     -7915.418       16.581     843.079
V9       -5363.749      -5344.718     -5651.512       38.062     613.589
V10      -5863.850      -5832.549     -6278.749       62.603     892.400
V11      -4584.566      -4559.094     -4739.475       50.942     360.761
V12      -5957.646      -5945.691     -6334.969       23.911     778.557
V13      -6692.829      -6676.599     -7052.877       32.460     752.556
V14      -7272.464      -7264.750     -7484.136       15.430     438.773
V15      -5494.622      -5482.526     -5671.696       24.191     378.339
V16      -7695.819      -7677.771     -7932.825       36.096     510.108
V17      -7668.913      -7648.705     -7840.940       40.415     384.469
V18      -3796.026      -3783.318     -4111.067       25.415     655.498
V19      -5510.826      -5480.577     -5875.229       60.497     789.305
V20      -6408.038      -6398.886     -6530.508       18.303     263.243
V21      -7059.259      -7044.781     -7265.923       28.956     442.284
V22      -5566.685      -5555.075     -5725.569       23.221     340.988
V23      -7106.103      -7077.207     -7325.641       57.792     496.868
V24      -5624.034      -5595.718     -5977.572       56.632     763.708
V25      -4929.768      -4919.555     -5213.298       20.426     587.487
V26      -6249.252      -6231.147     -6623.748       36.208     785.201
V27      -4811.700      -4793.779     -5093.165       35.843     598.773
V28      -7120.441      -7076.521     -7566.925       87.841     980.807
V29      -4785.925      -4746.734     -5115.821       78.381     738.173
V30      -3467.230      -3457.352     -3770.525       19.755     626.346
V31      -7343.773      -7310.918     -7557.430       65.710     493.023
V32      -6628.563      -6610.731     -6707.124       35.664     192.786
V33      -8455.109      -8439.761     -8583.957       30.696     288.392
V34      -6061.489      -6028.028     -6176.327       66.922     296.598
V35      -4914.306      -4897.214     -5070.488       34.183     346.546
    model_df null_df   NFI   RFI  IFI   TLI  CFI RMSEA      AIC      CAIC
V1     114.8     136 0.815 0.781 1.00 1.000 1.00 0.000 -182.932 -1045.515
V2      86.1     102 0.850 0.822 0.97 0.964 0.97 0.006  -68.203  -715.313
V3      86.1     102 0.897 0.878 1.00 1.000 1.00 0.000 -129.958  -776.026
V4     143.5     170 0.970 0.964 1.00 1.000 1.00 0.000 -268.033 -1346.664
V5      86.1     102 0.853 0.826 1.00 1.000 1.00 0.000 -109.635  -756.814
V6     143.5     170 0.882 0.861 1.00 1.000 1.00 0.000 -260.307 -1338.880
V7      86.1     102 1.000 1.000 1.00 0.000 0.00 0.000 -172.200  -819.120
V8     143.5     170 0.980 0.977 1.00 1.000 1.00 0.000 -270.419 -1349.108
V9     143.5     170 0.938 0.927 1.00 1.000 1.00 0.000 -248.938 -1327.627
V10    114.8     136 0.930 0.917 1.00 1.000 1.00 0.000 -166.997 -1029.764
V11    114.8     136 0.859 0.833 1.00 1.000 1.00 0.000 -178.658 -1041.586
V12    143.5     170 0.969 0.964 1.00 1.000 1.00 0.000 -263.089 -1341.691
V13    143.5     170 0.957 0.949 1.00 1.000 1.00 0.000 -254.540 -1333.171
V14    143.5     170 0.965 0.958 1.00 1.000 1.00 0.000 -271.570 -1349.626
V15    143.5     170 0.936 0.924 1.00 1.000 1.00 0.000 -262.809 -1341.497
V16    143.5     170 0.929 0.916 1.00 1.000 1.00 0.000 -250.904 -1329.506
V17    143.5     170 0.895 0.875 1.00 1.000 1.00 0.000 -246.585 -1322.725
V18     86.1     102 0.961 0.954 1.00 1.000 1.00 0.000 -146.785  -793.998
V19     86.1     102 0.923 0.909 1.00 1.000 1.00 0.000 -111.703  -758.795
V20     86.1     102 0.930 0.918 1.00 1.000 1.00 0.000 -153.897  -801.058
V21    143.5     170 0.935 0.922 1.00 1.000 1.00 0.000 -258.044 -1336.618
V22     86.1     102 0.932 0.919 1.00 1.000 1.00 0.000 -148.979  -795.933
V23    143.5     170 0.884 0.862 1.00 1.000 1.00 0.000 -229.208 -1307.724
V24     86.1     102 0.926 0.912 1.00 1.000 1.00 0.000 -115.568  -762.764
V25     86.1     102 0.965 0.959 1.00 1.000 1.00 0.000 -151.774  -798.935
V26    114.8     136 0.954 0.945 1.00 1.000 1.00 0.000 -193.392 -1056.158
V27    114.8     136 0.940 0.929 1.00 1.000 1.00 0.000 -193.757 -1056.017
V28    143.5     170 0.910 0.894 1.00 1.000 1.00 0.000 -199.159 -1277.790
V29    143.5     170 0.894 0.874 1.00 1.000 1.00 0.000 -208.619 -1287.279
V30    114.8     136 0.968 0.963 1.00 1.000 1.00 0.000 -209.845 -1072.680
V31    143.5     170 0.867 0.842 1.00 1.000 1.00 0.000 -221.290 -1299.950
V32     86.1     102 0.815 0.781 1.00 1.000 1.00 0.000 -136.536  -783.318
V33    143.5     170 0.894 0.874 1.00 1.000 1.00 0.000 -256.304 -1334.906
V34     86.1     102 0.774 0.733 1.00 1.000 1.00 0.000 -105.278  -752.439
V35     86.1     102 0.901 0.883 1.00 1.000 1.00 0.000 -138.017  -785.161
          BIC
V1   -930.715
V2   -629.213
V3   -689.926
V4  -1203.164
V5   -670.714
V6  -1195.380
V7   -733.020
V8  -1205.608
V9  -1184.127
V10  -914.964
V11  -926.786
V12 -1198.191
V13 -1189.671
V14 -1206.126
V15 -1197.997
V16 -1186.006
V17 -1179.225
V18  -707.898
V19  -672.695
V20  -714.958
V21 -1193.118
V22  -709.833
V23 -1164.224
V24  -676.664
V25  -712.835
V26  -941.358
V27  -941.217
V28 -1134.290
V29 -1143.779
V30  -957.880
V31 -1156.450
V32  -697.218
V33 -1191.406
V34  -666.339
V35  -699.061

Model Fit Indices
Number of Latent rank: 10
Number of EM cycle: 3 
                     value
model_log_like -209248.370
bench_log_like -208571.836
null_log_like  -217753.915
model_Chi_sq      1424.270
null_Chi_sq      18364.158
model_df          4104.100
null_df           4862.000
NFI                  0.922
RFI                  0.908
IFI                  1.000
TLI                  1.000
CFI                  1.000
RMSEA                0.000
AIC              -6783.930
CAIC            -52217.449
BIC             -48113.349</code></pre>
</div>
</div>
<section id="可視化baseグラフィックス-2" class="level4" data-number="5.4.1.1">
<h4 data-number="5.4.1.1" class="anchored" data-anchor-id="可視化baseグラフィックス-2"><span class="header-section-number">5.4.1.1</span> 可視化（baseグラフィックス）</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRArated, <span class="at">type =</span> <span class="st">"ScoreFreq"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRArated, <span class="at">type =</span> <span class="st">"ScoreRank"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRArated, <span class="at">type =</span> <span class="st">"ICRP"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nc =</span> <span class="dv">3</span>, <span class="at">nr =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRArated, <span class="at">type =</span> <span class="st">"RMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nc =</span> <span class="dv">3</span>, <span class="at">nr =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="可視化ggexametrika-2" class="level4" data-number="5.4.1.2">
<h4 data-number="5.4.1.2" class="anchored" data-anchor-id="可視化ggexametrika-2"><span class="header-section-number">5.4.1.2</span> 可視化（ggExametrika）</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotScoreFreq_gg</span>(result.LRArated)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotScoreRank_gg</span>(result.LRArated)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotICRP_gg</span>(result.LRArated, <span class="at">items =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="順序データ" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="順序データ"><span class="header-section-number">5.4.2</span> 順序データ</h3>
<p>サンプルデータ<code>J15S3810</code>（4件法）で順序データの分析例を示します。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>result.LRAord <span class="ot">&lt;-</span> <span class="fu">LRA</span>(J15S3810, <span class="at">nrank =</span> <span class="dv">3</span>, <span class="at">mic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>result.LRAord</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Monotonic increasing IRP option is TRUE.
Test Statistics
                  value
SampleSize 3810.0000000
TestLength   15.0000000
Median       15.0000000
Max          27.0000000
Min           0.0000000
Range        27.0000000
Mean         14.9939633
SD            4.5139980
Skewness      0.3003000
Kurtosis     -0.4333525
Alpha         0.4496500
Item Statistics
   ItemLabel  Obs ObsRatio ItemMean ItemSD ItemCORR ItemCORR_R
1         V1 3810    1.000     1.82  0.933    0.630      0.479
2         V2 3810    1.000     1.81  0.821    0.534      0.384
3         V3 3810    1.000     2.06  0.855    0.493      0.329
4         V4 2046    0.537     1.59  0.929    0.634      0.498
5         V5 2046    0.537     1.65  0.918    0.595      0.453
6         V6 2046    0.537     1.47  1.105    0.709      0.566
7         V7  985    0.259     1.39  0.819    0.554      0.381
8         V8  985    0.259     0.71  0.793    0.454      0.269
9         V9  985    0.259     1.35  0.910    0.522      0.319
10       V10 1513    0.397     2.04  0.827    0.486      0.311
11       V11 1513    0.397     1.42  0.966    0.593      0.408
12       V12 1513    0.397     1.85  0.822    0.360      0.172
13       V13 3076    0.807     1.48  0.928    0.616      0.457
14       V14 3076    0.807     1.73  0.876    0.353      0.163
15       V15 3076    0.807     1.45  0.757    0.526      0.384
Item Category Reference Profile
   ItemLabel CategoryLabel   rank1   rank2   rank3
1         V1       V1-Cat1 0.17393 0.06951 0.00704
2         V1       V1-Cat2 0.42330 0.27640 0.07185
3         V1       V1-Cat3 0.33817 0.44564 0.31088
4         V1       V1-Cat4 0.06460 0.20845 0.61023
5         V2       V2-Cat1 0.09199 0.04891 0.01161
6         V2       V2-Cat2 0.41088 0.28949 0.12343
7         V2       V2-Cat3 0.43340 0.51812 0.39887
8         V2       V2-Cat4 0.06373 0.14348 0.46609
9         V3       V3-Cat1 0.09074 0.02676 0.00868
10        V3       V3-Cat2 0.29715 0.19562 0.09573
11        V3       V3-Cat3 0.42516 0.41144 0.35395
12        V3       V3-Cat4 0.18695 0.36617 0.54165
13        V4       V4-Cat1 0.27087 0.10688 0.02022
14        V4       V4-Cat2 0.47221 0.35211 0.16032
15        V4       V4-Cat3 0.23312 0.43312 0.42526
16        V4       V4-Cat4 0.02380 0.10789 0.39420
17        V5       V5-Cat1 0.22340 0.09038 0.02552
18        V5       V5-Cat2 0.45741 0.36696 0.14520
19        V5       V5-Cat3 0.27537 0.41469 0.42625
20        V5       V5-Cat4 0.04382 0.12797 0.40303
21        V6       V6-Cat1 0.43038 0.25635 0.04169
22        V6       V6-Cat2 0.41436 0.37635 0.11136
23        V6       V6-Cat3 0.13945 0.24502 0.26558
24        V6       V6-Cat4 0.01581 0.12228 0.58137
25        V7       V7-Cat1 0.19342 0.08500 0.02569
26        V7       V7-Cat2 0.52560 0.48260 0.23858
27        V7       V7-Cat3 0.25818 0.38193 0.38562
28        V7       V7-Cat4 0.02281 0.05046 0.35011
29        V8       V8-Cat1 0.56243 0.46781 0.27695
30        V8       V8-Cat2 0.33366 0.42709 0.32737
31        V8       V8-Cat3 0.09674 0.09705 0.28664
32        V8       V8-Cat4 0.00718 0.00805 0.10904
33        V9       V9-Cat1 0.26564 0.15281 0.06193
34        V9       V9-Cat2 0.44314 0.40111 0.25979
35        V9       V9-Cat3 0.25546 0.33277 0.37397
36        V9       V9-Cat4 0.03576 0.11331 0.30432
37       V10      V10-Cat1 0.08296 0.02333 0.01380
38       V10      V10-Cat2 0.32586 0.18196 0.06768
39       V10      V10-Cat3 0.41930 0.47685 0.41845
40       V10      V10-Cat4 0.17188 0.31785 0.50008
41       V11      V11-Cat1 0.29385 0.19159 0.05163
42       V11      V11-Cat2 0.43936 0.44759 0.17525
43       V11      V11-Cat3 0.23040 0.28055 0.37228
44       V11      V11-Cat4 0.03638 0.08028 0.40084
45       V12      V12-Cat1 0.08050 0.03378 0.02447
46       V12      V12-Cat2 0.35319 0.27987 0.20563
47       V12      V12-Cat3 0.39439 0.45647 0.48503
48       V12      V12-Cat4 0.17192 0.22988 0.28487
49       V13      V13-Cat1 0.23012 0.14655 0.02526
50       V13      V13-Cat2 0.52102 0.44594 0.18083
51       V13      V13-Cat3 0.22398 0.33397 0.34235
52       V13      V13-Cat4 0.02488 0.07354 0.45155
53       V14      V14-Cat1 0.11483 0.07507 0.05915
54       V14      V14-Cat2 0.37410 0.28213 0.22853
55       V14      V14-Cat3 0.36439 0.44259 0.44626
56       V14      V14-Cat4 0.14668 0.20021 0.26606
57       V15      V15-Cat1 0.15989 0.06605 0.01194
58       V15      V15-Cat2 0.57231 0.45914 0.28880
59       V15      V15-Cat3 0.25821 0.43886 0.48419
60       V15      V15-Cat4 0.00959 0.03596 0.21506

Test Profile
                               Rank 1   Rank 2   Rank 3
Test Reference Profile         18.132   23.240   31.867
Latent Rank Ditribution      1400.000 1360.000 1050.000
Rank Membership Distribution 1390.233 1326.565 1093.202

Item Fit Indices
    model_log_like bench_log_like null_log_like model_Chi_sq null_Chi_sq
V1       -4194.252      -4138.683     -4922.273      111.139    1567.180
V2       -4130.419      -4096.318     -4574.412       68.203     956.188
V3       -4294.276      -4212.421     -4562.273      163.711     699.705
V4       -2308.585      -2216.974     -2675.639      183.221     917.331
V5       -2351.710      -2295.513     -2652.801      112.395     714.576
V6       -2266.300      -2168.314     -2823.022      195.972    1309.416
V7       -1070.247      -1014.803     -1184.386      110.888     339.167
V8       -1006.878       -983.347     -1068.390       47.061     170.085
V9       -1198.215      -1143.101     -1270.518      110.228     254.833
V10      -1668.660      -1594.943     -1785.080      147.434     380.274
V11      -1791.440      -1762.699     -2015.011       57.482     504.624
V12      -1782.452      -1746.861     -1814.057       71.183     134.393
V13      -3450.743      -3336.976     -4001.750      227.532    1329.547
V14      -3810.641      -3807.989     -3868.310        5.304     120.643
V15      -3144.090      -3069.644     -3488.638      148.893     837.988
    model_df null_df   NFI   RFI   IFI   TLI   CFI RMSEA     AIC     CAIC
V1    36.616      42 0.929 0.919 0.951 0.944 0.951 0.023  37.907 -227.388
V2    36.616      42 0.929 0.918 0.966 0.960 0.965 0.015  -5.029 -270.324
V3    36.616      42 0.766 0.732 0.808 0.778 0.807 0.030  90.479 -174.816
V4    36.616      42 0.800 0.771 0.834 0.808 0.833 0.044 109.990 -132.540
V5    36.616      42 0.843 0.820 0.888 0.871 0.887 0.032  39.163 -203.367
V6    36.616      42 0.850 0.828 0.875 0.856 0.874 0.046 122.741 -119.789
V7    36.616      42 0.673 0.625 0.755 0.713 0.750 0.045  37.656 -178.107
V8    36.616      42 0.723 0.683 0.922 0.906 0.918 0.017 -26.170 -241.934
V9    36.616      42 0.567 0.504 0.663 0.603 0.654 0.045  36.996 -178.768
V10   36.616      42 0.612 0.555 0.678 0.624 0.672 0.045  74.202 -157.277
V11   36.616      42 0.886 0.869 0.955 0.948 0.955 0.019 -15.750 -247.229
V12   36.616      42 0.470 0.392 0.646 0.571 0.626 0.025  -2.049 -233.528
V13   36.616      42 0.829 0.804 0.852 0.830 0.852 0.041 154.301 -103.159
V14   36.616      42 0.956 0.950 1.000 1.000 1.000 0.000 -67.927 -325.387
V15   36.616      42 0.822 0.796 0.860 0.838 0.859 0.032  75.661 -181.798
         BIC
V1  -190.773
V2  -233.708
V3  -138.200
V4   -95.925
V5  -166.751
V6   -83.173
V7  -141.492
V8  -205.318
V9  -142.152
V10 -120.662
V11 -210.614
V12 -196.912
V13  -66.543
V14 -288.771
V15 -145.183

Model Fit Indices
Number of Latent rank: 3
Number of EM cycle: 9 
                    value
model_log_like -38467.180
bench_log_like -37588.585
null_log_like  -42706.560
model_Chi_sq     1760.646
null_Chi_sq     10235.950
model_df          549.237
null_df           630.000
NFI                 0.828
RFI                 0.803
IFI                 0.875
TLI                 0.855
CFI                 0.874
RMSEA               0.008
AIC               662.172
CAIC            -4524.057
BIC             -3974.820</code></pre>
</div>
</div>
<section id="可視化baseグラフィックス-3" class="level4" data-number="5.4.2.1">
<h4 data-number="5.4.2.1" class="anchored" data-anchor-id="可視化baseグラフィックス-3"><span class="header-section-number">5.4.2.1</span> 可視化（baseグラフィックス）</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRAord, <span class="at">type =</span> <span class="st">"ScoreFreq"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRAord, <span class="at">type =</span> <span class="st">"ScoreRank"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRAord, <span class="at">type =</span> <span class="st">"ICBR"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nc =</span> <span class="dv">3</span>, <span class="at">nr =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRAord, <span class="at">type =</span> <span class="st">"ICRP"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nc =</span> <span class="dv">3</span>, <span class="at">nr =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.LRAord, <span class="at">type =</span> <span class="st">"RMP"</span>, <span class="at">students =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nc =</span> <span class="dv">3</span>, <span class="at">nr =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="可視化ggexametrika-3" class="level4" data-number="5.4.2.2">
<h4 data-number="5.4.2.2" class="anchored" data-anchor-id="可視化ggexametrika-3"><span class="header-section-number">5.4.2.2</span> 可視化（ggExametrika）</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotICBR_gg</span>(result.LRAord, <span class="at">items =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotICRP_gg</span>(result.LRAord, <span class="at">items =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotRMP_gg</span>(result.LRAord)[[<span class="dv">1</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chap04_LCA_LRA_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chap03_IRT.html" class="pagination-link" aria-label="項目反応理論">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">項目反応理論</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap05_Biclustering.html" class="pagination-link" aria-label="バイクラスタリング">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">バイクラスタリング</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>