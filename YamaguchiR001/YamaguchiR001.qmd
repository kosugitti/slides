---
title: "関数とパッケージの作り方"
subtitle: "初級から中級へのステップアップ"
author:
  - name: "Koji Kosugi"
    degrees: PhD
    url: "https://kosugitti.github.io/kosugitti10/"
    affiliations: Senshu University
    email: kosugitti_at_gmail.com
format: 
    revealjs:
        theme: serif
        footer: "Yamaguchi.R Advanced Session"
        logo: logo.png
        height: 900
        width:  1600
        transition: slide
        slide-number: true
editor: 
    render-on-save: true
---


## 自己紹介 
::: columns
::: {.column width="60%"}

小杉考司（こすぎこうじ）

[{{< fa brands github >}}](https://github.com/kosugitti)
[{{< fa brands discord >}}]()
[{{< fa brands instagram >}}]()
[{{< fa brands x-twitter >}}](https://twitter.com/kosugitti)@kosugitti

<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M4.907 3.44c.709.12 1.533.501 2.576 1.247C9.28 5.97 10.769 7.739 12 9.564c1.231-1.825 2.72-3.593 4.517-4.877c1.043-.746 1.867-1.127 2.576-1.248c.767-.13 1.29.065 1.615.2C21.717 4.06 22 5.225 22 6.215c0 .201-.086 1.302-.185 2.36c-.052.546-.11 1.108-.166 1.577c-.053.428-.115.88-.19 1.133a4.331 4.331 0 0 1-1.951 2.517c.937.707 1.277 1.856.928 2.984c-.597 1.924-2.737 4.397-4.835 4.618c-1.773.186-2.935-1.325-3.601-2.76c-.666 1.435-1.828 2.946-3.6 2.76c-2.099-.22-4.24-2.694-4.836-4.618c-.35-1.128-.01-2.277.928-2.984a4.331 4.331 0 0 1-1.95-2.517c-.076-.253-.138-.705-.19-1.133a60.58 60.58 0 0 1-.167-1.577C2.085 7.517 2 6.416 2 6.215c0-.99.283-2.155 1.292-2.576c.326-.135.847-.33 1.615-.2M4.05 6.916c.064.818.18 2.108.288 2.992c.032.268.055.545.122.807c.397 1.34 1.929 2.082 3.686 1.887a1 1 0 0 1 .257 1.983c-.756.112-3.315.357-2.928 1.607c.357 1.151 1.848 3.087 3.134 3.222c.928.097 1.5-1.394 1.766-2.045c.275-.674.488-1.38.668-1.982a1 1 0 0 1 1.916 0c.18.602.393 1.308.668 1.982c.266.651.838 2.142 1.766 2.045c1.286-.135 2.777-2.07 3.134-3.222c.387-1.25-2.172-1.495-2.928-1.607a1 1 0 0 1 .257-1.983c1.757.195 3.289-.547 3.686-1.887c.069-.266.089-.536.122-.807a80.35 80.35 0 0 0 .288-2.992c.037-.468.247-1.637-.522-1.506c-.286.049-.823.241-1.749.903c-1.943 1.389-3.705 3.513-4.789 5.64a1 1 0 0 1-1.782 0c-1.084-2.127-2.846-4.251-4.789-5.64c-.926-.662-1.463-.854-1.749-.903c-.784-.134-.559 1.034-.522 1.506"/>@kosugitti.bsky.social</svg>

[{{< fa brands mastodon >}}Kosugitti@mastdon.jp]()

[{{< fa brands orcid >}}0000-0001-5816-0099](https://orcid.org/0000-0001-5816-0099)



### 略歴

-   1976.01.17 大阪府大阪市生まれ
-   2007.04～2018.03 山口大学教育学部に奉職
    -   大殿のあたりに住んでました
-   2018.04〜専修大学人間科学部

### 専門

-   数理社会心理学(社会心理学＋心理統計)

### R歴

-   2007年から本格利用開始
:::

::: {.column width="40%"}
あとでじゃん献本しましょう。

::: r-stack
![](kosBlack.jpg){.fragment width="450"}

![](RUMS1.jpg){.fragment width="450"}

![](RUMS2.jpg){.fragment width="450"}

![](SimBook.jpg){.fragment width="450"}
:::
:::
:::

## 中級者とは何か

初級者を名乗るのは簡単なことですが，どこから中級者を名乗ればいいのかは難しい。

-   利用歴X年目から？
-   パイプ演算子を使い始めたら？

個人的には，↓ぐらいが中級者のラインではないかと。ちなみに，いずれも「案ずるより産むが易し」で，やってみたら意外と簡単なステップなんです。

-   SピーSSなど，他の統計ソフトをアンインストールした
-   関数やパッケージを作り始めた
-   Quarto/Github/Shinyなどに手を出し始めた

今日は**「関数とパッケージの作り方」**をお話しするので，今日の話を聞き終わったら皆さんも中級者？

## 余談；Quartoって？

### Quartoとは，文書作成ツールの名称。

+ マークダウンという書式をつかって，プレーンテキストに記号を書き込みながら文書を作成します。
+ HTML言語をブラウザが読める形にレイアウトするように，Quartoで書かれた文書をコンパイルしてhtmlやpdf,docx,epub,pptxなどのファイルに出力できます。
+ このスライドもQuartoを使ってhtmlに変換しています。

### Rmarkdownとどう違うの？

+ RStudioにはRmarkdownという書式があり，これも同じような仕組み。
+ RmarkdownやQuartoを使うメリットは，文書作成，統計計算，図の可視化などが一枚のファイルでできるので，別々のアプリを使って作る必要がないこと，計算プロセスなども文書に埋め込めることなどが利点。
+ QuartoはRmarkdownの上位互換で，最近Posit社が力を入れている書式であり，RだけでなくPython, Juliaなど複数の言語をサポートしているところが特徴的。

# 関数を作る

## 関数をつかう

## 関数を作る1；引数がひとつのばあい

## 関数を作る2；引数がふたつのばあい

## 関数を作る3；デフォルトの設定

## 関数を作る4；注意点(スコープ)

## Hands-on!

## 関数を作るメリット

### いつ作るのか

### カプセル化

# パッケージを作る

## パッケージを使う

### パッケージを「使う」のは割と敷居が低い

Rではデフォルトで持っているパッケージでも一通りの計算ができるが，より便利に・より専門的に使うためにはパッケージの導入は必須。

(心理統計で)よく使うパッケージとしては次のようなものが

-   tidyverse
-   psych
-   rstan/cmdstanr

これらは`library`関数で呼び出すことができる。欲しいパッケージはインターネットからとってくることができる。

-   install.packages関数でインストール
-   update.packages関数で一括アップデート
-   RStudioのPacagesタブでGUI操作も！

## あなたのパッケージはどこから?

-   一般的には，**CRAN(The Comprehensive R Archive Network)**という書庫ネットワークからダウンロードする(している)。 ![CRAN一覧](CRAN.png)
-   古いパッケージでもはやCRANに載っていない，というときはアーカイブや作者のサイトからファイルをダウンロードしたりする。ちなみに，パッケージは複数のファイルをまとめて`.tar.gz`形式で圧縮されています。^[Unix系の圧縮方法で，tarで複数のファイルを一つにまとめ，gzipで圧縮するという2段階ステップを経ているのでこんな感じの拡張子になる。]
- 最近はGithubをつかって公開されていることも多く，`devtools`パッケージ



## パッケージを作るメリット

## 自分だけのひみつパッケージ

## Build！

## パッケージの公開の仕方

## ライセンスを考えよう

## ヘルプの書き方；roxygen

## Check and Build

# Enjoy!
